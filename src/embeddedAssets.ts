// AIGC START
export type EmbeddedAsset = { content: Buffer | string; type: string };
export const assets: Record<string, EmbeddedAsset> = {
  "/css/main.css": { content: "/* åŸºç¡€æ ·å¼é‡ç½® */\n* {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n}\n\n:root {\n    /* äº®è‰²ä¸»é¢˜ */\n    --bg-primary: #ffffff;\n    --bg-secondary: #f8f9fa;\n    --bg-tertiary: #e9ecef;\n    --text-primary: #212529;\n    --text-secondary: #6c757d;\n    --border-color: #dee2e6;\n    --accent-color: #007bff;\n    --accent-hover: #0056b3;\n    --shadow: rgba(0, 0, 0, 0.1);\n    --code-bg: #f8f9fa;\n    --code-text: #e83e8c;\n    --hover-color: rgba(0, 123, 255, 0.1);\n}\n\nbody {\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n    line-height: 1.6;\n    color: var(--text-primary);\n    background-color: var(--bg-primary);\n}\n\n/* åº”ç”¨å¸ƒå±€ */\n.app {\n    height: 100vh;\n    display: flex;\n    flex-direction: column;\n}\n\n/* å¤´éƒ¨å¯¼èˆª */\n.header {\n    background: var(--bg-secondary);\n    border-bottom: 1px solid var(--border-color);\n    padding: 0.75rem 1rem;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    box-shadow: 0 1px 3px var(--shadow);\n}\n\n.header-left {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n}\n\n.header h1 {\n    font-size: 1.25rem;\n    font-weight: 600;\n    color: var(--text-primary);\n}\n\n.breadcrumb {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    font-size: 0.875rem;\n    color: var(--text-secondary);\n}\n\n.breadcrumb-item {\n    padding: 0.25rem 0.5rem;\n    background: var(--bg-tertiary);\n    border-radius: 0.25rem;\n    cursor: pointer;\n    transition: background 0.2s ease;\n}\n\n.breadcrumb-item:hover {\n    background: var(--accent-color);\n    color: white;\n}\n\n.header-right {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.mobile-menu-toggle {\n    display: none;\n    background: none;\n    border: 1px solid var(--border-color);\n    border-radius: 0.25rem;\n    padding: 0.5rem;\n    cursor: pointer;\n    transition: all 0.2s ease;\n}\n\n.mobile-menu-toggle:hover {\n    background: var(--bg-tertiary);\n}\n\n.sidebar-toggle {\n    background: none;\n    border: 1px solid var(--border-color);\n    border-radius: 0.25rem;\n    padding: 0.5rem;\n    cursor: pointer;\n    transition: all 0.2s ease;\n    margin-right: 0.5rem;\n}\n\n.sidebar-toggle:hover {\n    background: var(--bg-tertiary);\n}\n\n.sidebar-toggle.collapsed .sidebar-icon {\n    transform: rotate(180deg);\n}\n\n.theme-toggle {\n    background: none;\n    border: 1px solid var(--border-color);\n    border-radius: 0.25rem;\n    padding: 0.5rem;\n    cursor: pointer;\n    transition: all 0.2s ease;\n}\n\n.theme-toggle:hover {\n    background: var(--bg-tertiary);\n}\n\n/* ä¸»å®¹å™¨ */\n.main-container {\n    flex: 1;\n    display: flex;\n    overflow: hidden;\n    position: relative;\n}\n\n.main-container.sidebar-collapsed .sidebar {\n    margin-left: -280px;\n    width: 0;\n}\n\n.main-container.sidebar-collapsed .sidebar-collapsed {\n    display: flex !important;\n}\n\n.main-container.sidebar-collapsed .outline-panel {\n    border-left: 1px solid var(--border-color);\n}\n\n.main-container.sidebar-collapsed .content-area {\n    margin-left: 40px;\n}\n\n/* ä¾§è¾¹æ  */\n.sidebar {\n    width: 280px;\n    background: var(--bg-secondary);\n    border-right: 1px solid var(--border-color);\n    display: flex;\n    flex-direction: column;\n    overflow: hidden;\n    transition: margin-left 0.3s ease, width 0.3s ease;\n    position: relative;\n}\n\n.sidebar.collapsed {\n    margin-left: -280px;\n    width: 0;\n}\n\n/* ä¾§è¾¹æ æ”¶èµ·æ—¶çš„ç¼©ç•¥æ¡ */\n.sidebar-collapsed {\n    width: 40px;\n    background: var(--bg-secondary);\n    border-right: 1px solid var(--border-color);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    padding: 1rem 0;\n    transition: all 0.3s ease;\n    cursor: pointer;\n}\n\n.sidebar-collapsed:hover {\n    background: var(--bg-tertiary);\n}\n\n.sidebar-toggle-collapsed {\n    background: none;\n    border: none;\n    padding: 0.5rem;\n    cursor: pointer;\n    border-radius: 0.25rem;\n    transition: background 0.2s ease;\n    margin-bottom: 1rem;\n}\n\n.sidebar-toggle-collapsed:hover {\n    background: var(--bg-tertiary);\n}\n\n.sidebar-collapsed-title {\n    writing-mode: vertical-rl;\n    text-orientation: mixed;\n    font-size: 0.875rem;\n    font-weight: 600;\n    color: var(--text-secondary);\n    margin-top: 1rem;\n    letter-spacing: 2px;\n}\n\n.sidebar-header {\n    padding: 1rem;\n    border-bottom: 1px solid var(--border-color);\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n}\n\n.sidebar-header h3 {\n    font-size: 1rem;\n    font-weight: 600;\n    color: var(--text-primary);\n}\n\n.refresh-btn {\n    background: none;\n    border: none;\n    padding: 0.25rem;\n    cursor: pointer;\n    border-radius: 0.25rem;\n    transition: background 0.2s ease;\n}\n\n.refresh-btn:hover {\n    background: var(--bg-tertiary);\n}\n\n.file-tree {\n    flex: 1;\n    overflow-y: auto;\n    padding: 0.5rem;\n}\n\n/* å¤§çº²é¢æ¿ */\n.outline-panel {\n    width: 250px;\n    background: var(--bg-primary);\n    border-right: 1px solid var(--border-color);\n    display: flex;\n    flex-direction: column;\n    overflow: hidden;\n}\n\n.outline-header {\n    padding: 1rem;\n    border-bottom: 1px solid var(--border-color);\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n}\n\n.outline-header h3 {\n    font-size: 1rem;\n    font-weight: 600;\n    color: var(--text-primary);\n}\n\n.toggle-outline {\n    background: none;\n    border: none;\n    padding: 0.25rem;\n    cursor: pointer;\n    border-radius: 0.25rem;\n    transition: background 0.2s ease;\n}\n\n.toggle-outline:hover {\n    background: var(--bg-tertiary);\n}\n\n.outline-content {\n    flex: 1;\n    overflow-y: auto;\n    padding: 0.5rem;\n}\n\n/* æŠ½å±‰æ”¶èµ·æ ·å¼ */\n.outline-panel.collapsed {\n    width: 40px !important;\n}\n.outline-panel.collapsed .outline-header {\n    padding: 0.25rem;\n    justify-content: center;\n}\n.outline-panel.collapsed .outline-header h3 {\n    display: none;\n}\n.outline-panel.collapsed .outline-content {\n    display: none;\n}\n\n/* å†…å®¹åŒºåŸŸ */\n.content-area {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    overflow: hidden;\n}\n\n.content-header {\n    padding: 1rem;\n    border-bottom: 1px solid var(--border-color);\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    background: var(--bg-primary);\n}\n\n.content-header h2 {\n    font-size: 1.25rem;\n    font-weight: 600;\n    color: var(--text-primary);\n}\n\n.content-actions {\n    display: flex;\n    gap: 0.5rem;\n}\n\n.edit-btn, .refresh-content {\n    background: none;\n    border: 1px solid var(--border-color);\n    border-radius: 0.25rem;\n    padding: 0.5rem;\n    cursor: pointer;\n    transition: all 0.2s ease;\n}\n\n.edit-btn:hover, .refresh-content:hover {\n    background: var(--bg-tertiary);\n}\n\n.content-body {\n    flex: 1;\n    overflow-y: auto;\n    padding: 2rem;\n    background: var(--bg-primary);\n}\n\n/* æ¬¢è¿æ¶ˆæ¯ */\n.welcome-message {\n    text-align: center;\n    max-width: 600px;\n    margin: 0 auto;\n    padding: 2rem;\n}\n\n.welcome-message h2 {\n    font-size: 2rem;\n    margin-bottom: 1rem;\n    color: var(--text-primary);\n}\n\n.welcome-message p {\n    font-size: 1.1rem;\n    color: var(--text-secondary);\n    margin-bottom: 2rem;\n}\n\n.features {\n    text-align: left;\n    background: var(--bg-secondary);\n    padding: 2rem;\n    border-radius: 0.5rem;\n    margin-bottom: 2rem;\n}\n\n.features h3 {\n    margin-bottom: 1rem;\n    color: var(--text-primary);\n}\n\n.features ul {\n    list-style: none;\n    padding: 0;\n}\n\n.features li {\n    padding: 0.5rem 0;\n    font-size: 1rem;\n}\n\n.tip {\n    font-style: italic;\n    color: var(--text-secondary);\n    background: var(--bg-tertiary);\n    padding: 1rem;\n    border-radius: 0.5rem;\n    border-left: 4px solid var(--accent-color);\n}\n\n/* åŠ è½½çŠ¶æ€ */\n.loading {\n    text-align: center;\n    padding: 2rem;\n    color: var(--text-secondary);\n}\n\n.placeholder {\n    text-align: center;\n    padding: 2rem;\n    color: var(--text-secondary);\n    font-style: italic;\n}\n\n/* æ–‡ä»¶æ ‘æ ·å¼ */\n.file-tree-item {\n    display: flex;\n    align-items: center;\n    padding: 0.5rem;\n    cursor: pointer;\n    border-radius: 0.25rem;\n    transition: background 0.2s ease, transform 0.1s ease;\n    position: relative;\n    user-select: none;\n}\n\n.file-tree-item:hover {\n    background: var(--bg-tertiary);\n    transform: translateX(2px);\n}\n\n.file-tree-item.active {\n    background: var(--accent-color);\n    color: white;\n}\n\n.file-tree-item.focused {\n    outline: 2px solid var(--accent-color);\n    outline-offset: -2px;\n    background: var(--hover-color);\n}\n\n.file-tree-item.directory {\n    font-weight: 500;\n}\n\n.file-tree-item.file {\n    padding-left: 1.5rem;\n}\n\n.file-icon {\n    margin-right: 0.5rem;\n    width: 16px;\n    text-align: center;\n    font-size: 14px;\n    transition: transform 0.2s ease;\n}\n\n.file-name {\n    flex: 1;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.add-file-btn {\n    margin-left: 0.5rem;\n    border: 1px solid var(--border-color);\n    background: none;\n    border-radius: 0.25rem;\n    padding: 0.1rem 0.4rem;\n    cursor: pointer;\n    font-size: 0.875rem;\n}\n\n.add-file-btn:hover {\n    background: var(--bg-tertiary);\n}\n\n.expand-icon {\n    margin-right: 0.25rem;\n    width: 12px;\n    text-align: center;\n    transition: transform 0.3s ease, color 0.2s ease;\n    font-size: 10px;\n    color: var(--text-secondary);\n    cursor: pointer;\n}\n\n.expand-icon:hover {\n    color: var(--accent-color);\n    transform: scale(1.2);\n}\n\n.expand-icon.expanded {\n    transform: rotate(90deg);\n    color: var(--accent-color);\n}\n\n/* æ–‡ä»¶æ ‘å­é¡¹å®¹å™¨ */\n.file-tree-children {\n    max-height: 0;\n    overflow: hidden;\n    opacity: 0;\n    transition: max-height 0.3s ease, opacity 0.3s ease, padding 0.3s ease;\n    padding-left: 0;\n}\n\n.file-tree-children.expanded {\n    max-height: 1000px;\n    opacity: 1;\n}\n\n.file-tree-wrapper {\n    margin-bottom: 0.125rem;\n}\n\n/* æ–‡ä»¶æ ‘å·¥å…·æ  */\n.file-tree-toolbar {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 0.5rem;\n    border-bottom: 1px solid var(--border-color);\n    background: var(--bg-tertiary);\n}\n\n.file-tree-search {\n    flex: 1;\n    margin-right: 0.5rem;\n    padding: 0.25rem 0.5rem;\n    border: 1px solid var(--border-color);\n    border-radius: 0.25rem;\n    background: var(--bg-primary);\n    color: var(--text-primary);\n    font-size: 0.875rem;\n}\n\n.file-tree-search:focus {\n    outline: none;\n    border-color: var(--accent-color);\n    box-shadow: 0 0 0 2px var(--hover-color);\n}\n\n/* ç»Ÿä¸€å¼¹çª—æ ·å¼ï¼ˆä¸ç¼–è¾‘å™¨ä¸€è‡´ï¼‰ */\n.modal-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.35); display:none; align-items:center; justify-content:center; z-index: 2000; }\n.modal { width: 720px; max-width: 95vw; background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 6px; box-shadow: 0 8px 24px rgba(0,0,0,0.2); }\n.modal-header { padding: 0.75rem 1rem; border-bottom: 1px solid var(--border-color); font-weight: 600; }\n.modal-body { display:flex; gap:12px; padding: 0.75rem 1rem; }\n.modal-footer { display:flex; justify-content:flex-end; gap:8px; padding: 0.75rem 1rem; border-top: 1px solid var(--border-color); }\n.tree-pane { flex: 1 1 60%; border: 1px solid var(--border-color); border-radius:6px; padding:8px; max-height: 50vh; overflow:auto; }\n.form-pane { flex: 1 1 40%; display:flex; flex-direction:column; gap:8px; }\n.form-pane input { padding:8px; border:1px solid var(--border-color); border-radius:4px; background: var(--bg-primary); color: var(--text-primary); }\n.tree-item { cursor: pointer; padding:4px 6px; border-radius:4px; }\n.tree-item:hover { background: var(--bg-secondary); }\n.tree-item.selected { background: var(--bg-secondary); outline: 1px solid var(--border-color); }\n\n/* å³é”®èœå• */\n.context-menu {\n    position: absolute;\n    background: var(--bg-primary);\n    border: 1px solid var(--border-color);\n    border-radius: 0.25rem;\n    box-shadow: 0 4px 12px var(--shadow);\n    z-index: 1000;\n    min-width: 150px;\n    padding: 0.25rem 0;\n    display: none;\n}\n\n.context-menu-item {\n    padding: 0.5rem 1rem;\n    cursor: pointer;\n    transition: background 0.2s ease;\n    font-size: 0.875rem;\n    white-space: nowrap;\n}\n\n.context-menu-item:hover {\n    background: var(--bg-tertiary);\n}\n\n.context-menu-item:active {\n    background: var(--accent-color);\n    color: white;\n}\n\n.context-menu-separator {\n    height: 1px;\n    background: var(--border-color);\n    margin: 0.25rem 0;\n}\n\n/* å¤§çº²æ ·å¼ */\n.outline-item {\n    padding: 0.25rem 0;\n    cursor: pointer;\n    border-radius: 0.25rem;\n    transition: background 0.2s ease;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    user-select: none;\n}\n\n.outline-item:hover {\n    background: var(--bg-tertiary);\n    border-left: 3px solid var(--accent-color);\n}\n\n.outline-item:active {\n    background: var(--accent-color);\n    color: white;\n}\n\n.outline-item.level-1 {\n    padding-left: 0.5rem;\n    font-weight: 600;\n}\n\n.outline-item.level-2 {\n    padding-left: 1.5rem;\n}\n\n.outline-item.level-3 {\n    padding-left: 2.5rem;\n}\n\n.outline-item.level-4 {\n    padding-left: 3.5rem;\n}\n\n.outline-item.level-5 {\n    padding-left: 4.5rem;\n}\n\n.outline-item.level-6 {\n    padding-left: 5.5rem;\n}\n\n/* å“åº”å¼è®¾è®¡ */\n@media (max-width: 768px) {\n    .sidebar {\n        width: 240px;\n    }\n    \n    .sidebar.collapsed {\n        margin-left: -240px;\n        width: 0;\n    }\n    \n    .outline-panel {\n        width: 200px;\n    }\n    \n    .content-body {\n        padding: 1rem;\n    }\n    \n    .main-container.sidebar-collapsed .content-area {\n        margin-left: 40px;\n    }\n}\n\n@media (max-width: 640px) {\n    .mobile-menu-toggle {\n        display: block;\n    }\n    \n    .sidebar-toggle {\n        display: none; /* åœ¨å°å±å¹•ä¸Šéšè—æŠ½å±‰æŒ‰é’®ï¼Œä½¿ç”¨ç§»åŠ¨ç«¯èœå•æŒ‰é’® */\n    }\n    \n    .header h1 {\n        font-size: 1rem;\n    }\n    \n    .breadcrumb {\n        display: none;\n    }\n    \n    .sidebar, .outline-panel {\n        position: absolute;\n        z-index: 1000;\n        height: 100%;\n        box-shadow: 2px 0 8px var(--shadow);\n    }\n    \n    .sidebar {\n        left: -240px;\n        transition: left 0.3s ease;\n        margin-left: 0;\n        width: 240px;\n    }\n    \n    .sidebar.open {\n        left: 0;\n    }\n    \n    .sidebar.collapsed {\n        margin-left: 0;\n        width: 240px;\n        left: -240px;\n    }\n    \n    .outline-panel {\n        left: -200px;\n        transition: left 0.3s ease;\n    }\n    \n    /* ç§»åŠ¨ç«¯å±•å¼€/æ”¶èµ·ï¼šå±•å¼€æ—¶ç½®äºå¯è§åŒºåŸŸï¼›æ”¶èµ·æ—¶ä¿ç•™æŠŠæ‰‹ */\n    .outline-panel.open {\n        left: 0;\n    }\n    .outline-panel.collapsed {\n        left: 0 !important;\n        width: 40px !important;\n    }\n    \n    .mobile-menu-overlay {\n        display: none;\n        position: fixed;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        background: rgba(0, 0, 0, 0.5);\n        z-index: 999;\n    }\n    \n    .mobile-menu-overlay.active {\n        display: block;\n    }\n    \n    .sidebar-collapsed {\n        display: none; /* åœ¨å°å±å¹•ä¸Šéšè—ç¼©ç•¥æ¡ */\n    }\n    \n    .main-container.sidebar-collapsed .content-area {\n        margin-left: 0;\n    }\n}", type: "text/css; charset=utf-8" },
  "/css/themes.css": { content: "/* æš—è‰²ä¸»é¢˜ */\n[data-theme=\"dark\"] {\n    --bg-primary: #1a1a1a;\n    --bg-secondary: #2d2d2d;\n    --bg-tertiary: #404040;\n    --text-primary: #ffffff;\n    --text-secondary: #b0b0b0;\n    --border-color: #404040;\n    --accent-color: #4dabf7;\n    --accent-hover: #339af0;\n    --shadow: rgba(0, 0, 0, 0.3);\n    --code-bg: #2d2d2d;\n    --code-text: #ff6b6b;\n}\n\n/* è“è‰²ä¸»é¢˜ */\n[data-theme=\"blue\"] {\n    --bg-primary: #f0f8ff;\n    --bg-secondary: #e6f3ff;\n    --bg-tertiary: #cce7ff;\n    --text-primary: #1e3a8a;\n    --text-secondary: #3b82f6;\n    --border-color: #bfdbfe;\n    --accent-color: #2563eb;\n    --accent-hover: #1d4ed8;\n    --shadow: rgba(37, 99, 235, 0.1);\n    --code-bg: #e6f3ff;\n    --code-text: #dc2626;\n}\n\n/* ç»¿è‰²ä¸»é¢˜ */\n[data-theme=\"green\"] {\n    --bg-primary: #f0fdf4;\n    --bg-secondary: #dcfce7;\n    --bg-tertiary: #bbf7d0;\n    --text-primary: #14532d;\n    --text-secondary: #16a34a;\n    --border-color: #bbf7d0;\n    --accent-color: #15803d;\n    --accent-hover: #166534;\n    --shadow: rgba(21, 128, 61, 0.1);\n    --code-bg: #dcfce7;\n    --code-text: #dc2626;\n}\n\n/* ç´«è‰²ä¸»é¢˜ */\n[data-theme=\"purple\"] {\n    --bg-primary: #faf5ff;\n    --bg-secondary: #f3e8ff;\n    --bg-tertiary: #e9d5ff;\n    --text-primary: #581c87;\n    --text-secondary: #9333ea;\n    --border-color: #e9d5ff;\n    --accent-color: #7c3aed;\n    --accent-hover: #6d28d9;\n    --shadow: rgba(124, 58, 237, 0.1);\n    --code-bg: #f3e8ff;\n    --code-text: #dc2626;\n}\n\n/* ä¸»é¢˜åˆ‡æ¢åŠ¨ç”» */\n* {\n    transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;\n}\n\n/* ä»£ç å—ä¸»é¢˜é€‚é… */\npre[class*=\"language-\"] {\n    background: var(--code-bg) !important;\n    border: 1px solid var(--border-color);\n    border-radius: 0.5rem;\n    margin: 1rem 0;\n}\n\ncode[class*=\"language-\"] {\n    color: var(--code-text);\n}\n\n/* è¡¨æ ¼ä¸»é¢˜é€‚é… */\ntable {\n    border-collapse: collapse;\n    width: 100%;\n    margin: 1rem 0;\n    background: var(--bg-primary);\n}\n\nth, td {\n    border: 1px solid var(--border-color);\n    padding: 0.75rem;\n    text-align: left;\n}\n\nth {\n    background: var(--bg-secondary);\n    font-weight: 600;\n}\n\n/* å¼•ç”¨å—ä¸»é¢˜é€‚é… */\nblockquote {\n    border-left: 4px solid var(--accent-color);\n    padding-left: 1rem;\n    margin: 1rem 0;\n    background: var(--bg-secondary);\n    padding: 1rem 1rem 1rem 2rem;\n    border-radius: 0 0.5rem 0.5rem 0;\n}\n\n/* é“¾æ¥ä¸»é¢˜é€‚é… */\na {\n    color: var(--accent-color);\n    text-decoration: none;\n    transition: color 0.2s ease;\n}\n\na:hover {\n    color: var(--accent-hover);\n    text-decoration: underline;\n}\n\n/* å›¾ç‰‡ä¸»é¢˜é€‚é… */\nimg {\n    max-width: 100%;\n    height: auto;\n    border-radius: 0.5rem;\n    box-shadow: 0 2px 8px var(--shadow);\n}\n\n/* æ°´å¹³çº¿ä¸»é¢˜é€‚é… */\nhr {\n    border: none;\n    height: 1px;\n    background: var(--border-color);\n    margin: 2rem 0;\n}\n\n/* Mermaid å›¾è¡¨ä¸»é¢˜é€‚é… */\n.mermaid {\n    text-align: center;\n    margin: 2rem 0;\n    background: var(--bg-primary);\n    padding: 1rem;\n    border-radius: 0.5rem;\n    border: 1px solid var(--border-color);\n}\n\n/* PlantUML å›¾è¡¨ä¸»é¢˜é€‚é… */\n.plantuml {\n    text-align: center;\n    margin: 2rem 0;\n    background: var(--bg-primary);\n    padding: 1rem;\n    border-radius: 0.5rem;\n    border: 1px solid var(--border-color);\n}\n\n.plantuml img {\n    max-width: 100%;\n    height: auto;\n}\n\n/* æ»šåŠ¨æ¡ä¸»é¢˜é€‚é… */\n::-webkit-scrollbar {\n    width: 8px;\n    height: 8px;\n}\n\n::-webkit-scrollbar-track {\n    background: var(--bg-secondary);\n}\n\n::-webkit-scrollbar-thumb {\n    background: var(--border-color);\n    border-radius: 4px;\n}\n\n::-webkit-scrollbar-thumb:hover {\n    background: var(--text-secondary);\n}", type: "text/css; charset=utf-8" },
  "/editor.html": { content: "<!-- AIGC START -->\n<!DOCTYPE html>\n<html lang=\"zh-CN\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Markdown Editor</title>\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css\">\n    <link rel=\"stylesheet\" href=\"css/main.css\">\n    <link rel=\"stylesheet\" href=\"css/themes.css\">\n    <style>\n        /* ç¼–è¾‘å™¨é¡µé¢çš„æœ€å°å¢é‡æ ·å¼ï¼Œå¤ç”¨ä¸»ç«™è®¾è®¡å˜é‡ */\n        .editor-container { display: flex; height: 100vh; }\n        .editor-toolbar { padding: 0.5rem 1rem; border-bottom: 1px solid var(--border-color); background: var(--bg-secondary); display:flex; justify-content: space-between; align-items:center; }\n        .editor-actions { display:flex; gap:0.5rem; align-items:center; }\n        .edit-btn-group { display:flex; gap:4px; }\n        .editor-main { flex:1; display:flex; }\n        .editor-pane { flex:1; display:flex; flex-direction:column; }\n        .editor-pane.left { border-right: 1px solid var(--border-color); }\n        .editor-textarea { flex:1; width:100%; padding:1rem; border:none; outline:none; font-family: Menlo, Monaco, Consolas, \"Courier New\", monospace; font-size:14px; background: var(--bg-primary); color: var(--text-primary); }\n        .preview-pane { flex:1; display:flex; flex-direction:column; }\n        .preview-body { flex:1; overflow-y:auto; padding:1rem; background: var(--bg-primary); }\n        .status-bar { padding:0.25rem 1rem; font-size:0.875rem; color: var(--text-secondary); border-top:1px solid var(--border-color); background: var(--bg-secondary); }\n        .split-title { padding:0.5rem 1rem; border-bottom:1px solid var(--border-color); font-size:0.875rem; color: var(--text-secondary); background: var(--bg-secondary); }\n        .hidden { display:none; }\n        @media (max-width: 768px) { .editor-main { flex-direction: column; } .editor-pane.left { border-right:none; border-bottom: 1px solid var(--border-color); } }\n\n        /* Save As å¼¹çª— */\n        .modal-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.35); display:none; align-items:center; justify-content:center; z-index: 1000; }\n        .modal { width: 720px; max-width: 95vw; background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 6px; box-shadow: 0 8px 24px rgba(0,0,0,0.2); }\n        .modal-header { padding: 0.75rem 1rem; border-bottom: 1px solid var(--border-color); font-weight: 600; }\n        .modal-body { display:flex; gap:12px; padding: 0.75rem 1rem; }\n        .modal-footer { display:flex; justify-content:flex-end; gap:8px; padding: 0.75rem 1rem; border-top: 1px solid var(--border-color); }\n        .tree-pane { flex: 1 1 60%; border: 1px solid var(--border-color); border-radius:6px; padding:8px; max-height: 50vh; overflow:auto; }\n        .form-pane { flex: 1 1 40%; display:flex; flex-direction:column; gap:8px; }\n        .form-pane input { padding:8px; border:1px solid var(--border-color); border-radius:4px; background: var(--bg-primary); color: var(--text-primary); }\n        .tree-item { cursor: pointer; padding:4px 6px; border-radius:4px; }\n        .tree-item:hover { background: var(--bg-secondary); }\n        .tree-item.selected { background: var(--bg-secondary); outline: 1px solid var(--border-color); }\n    </style>\n</head>\n<body>\n    <div class=\"editor-container\">\n        <div class=\"editor-pane\" style=\"flex-basis:100%\">\n            <div class=\"editor-toolbar\">\n                <div class=\"editor-title\" id=\"editor-title\">Markdown ç¼–è¾‘å™¨</div>\n                <div class=\"editor-actions\">\n                    <button id=\"btn-back\" class=\"edit-btn\" title=\"è¿”å›é¢„è§ˆ\">âŸµ è¿”å›</button>\n                    <button id=\"btn-save\" class=\"edit-btn\" title=\"ä¿å­˜ (Cmd/Ctrl+S)\">ğŸ’¾ ä¿å­˜</button>\n                    <button id=\"btn-save-as\" class=\"edit-btn\" title=\"å¦å­˜ä¸º\">ğŸ“ å¦å­˜ä¸º</button>\n                    <div id=\"saveas-modal\" class=\"modal-backdrop\">\n                        <div class=\"modal\">\n                            <div class=\"modal-header\">å¦å­˜ä¸º</div>\n                            <div class=\"modal-body\">\n                                <div class=\"tree-pane\">\n                                    <div id=\"saveas-tree\"></div>\n                                </div>\n                                <div class=\"form-pane\">\n                                    <label for=\"saveas-dir\">ç›®æ ‡ç›®å½•</label>\n                                    <input id=\"saveas-dir\" type=\"text\" placeholder=\"ä¾‹å¦‚ï¼šdocs/notes\" />\n                                    <label for=\"saveas-name\">æ–‡ä»¶å</label>\n                                    <input id=\"saveas-name\" type=\"text\" placeholder=\"ä¾‹å¦‚ï¼šnew-file.md\" />\n                                    <small>ä»…æ”¯æŒ .md/.markdown/.mdown/.mkd/.mkdn</small>\n                                </div>\n                            </div>\n                            <div class=\"modal-footer\">\n                                <button id=\"saveas-cancel\" class=\"edit-btn\">å–æ¶ˆ</button>\n                                <button id=\"saveas-confirm\" class=\"edit-btn\">ä¿å­˜</button>\n                            </div>\n                        </div>\n                    </div>\n                    <div id=\"override-modal\" class=\"modal-backdrop\">\n                        <div class=\"modal\">\n                            <div class=\"modal-header\">å¹¶å‘å†²çª</div>\n                            <div class=\"modal-body\">\n                                <p>æ£€æµ‹åˆ°æ–‡ä»¶å·²è¢«å…¶ä»–ä¼šè¯ä¿®æ”¹ã€‚æ˜¯å¦è¦†ç›–ä¿å­˜ï¼Ÿ</p>\n                            </div>\n                            <div class=\"modal-footer\">\n                                <button id=\"override-cancel\" class=\"edit-btn\">å–æ¶ˆ</button>\n                                <button id=\"override-confirm\" class=\"edit-btn\">è¦†ç›–ä¿å­˜</button>\n                            </div>\n                        </div>\n                    </div>\n                    <button id=\"btn-bold\" class=\"edit-btn\" title=\"åŠ ç²— (Cmd/Ctrl+B)\">B</button>\n                    <button id=\"btn-italic\" class=\"edit-btn\" title=\"æ–œä½“ (Cmd/Ctrl+I)\"><i>I</i></button>\n                    <div class=\"edit-btn-group\">\n                        <button id=\"btn-h1\" class=\"edit-btn\" title=\"æ ‡é¢˜1 (Cmd/Ctrl+1)\">H1</button>\n                        <button id=\"btn-h2\" class=\"edit-btn\" title=\"H2 (Cmd/Ctrl+2)\">H2</button>\n                        <button id=\"btn-h3\" class=\"edit-btn\" title=\"H3 (Cmd/Ctrl+3)\">H3</button>\n                        <button id=\"btn-h4\" class=\"edit-btn\" title=\"H4 (Cmd/Ctrl+4)\">H4</button>\n                        <button id=\"btn-h5\" class=\"edit-btn\" title=\"H5 (Cmd/Ctrl+5)\">H5</button>\n                        <button id=\"btn-h6\" class=\"edit-btn\" title=\"H6 (Cmd/Ctrl+6)\">H6</button>\n                    </div>\n                    <button id=\"btn-toggle-preview\" class=\"edit-btn\" title=\"åˆ‡æ¢é¢„è§ˆ\">ğŸ” é¢„è§ˆå¼€å…³</button>\n                </div>\n            </div>\n            <div class=\"editor-main\">\n                <div class=\"editor-pane left\">\n                    <div class=\"split-title\">ç¼–è¾‘åŒº</div>\n                    <textarea id=\"editor-textarea\" class=\"editor-textarea\" placeholder=\"åœ¨æ­¤è¾“å…¥ Markdown å†…å®¹...\"></textarea>\n                    <div class=\"status-bar\" id=\"status\">å°±ç»ª</div>\n                </div>\n                <div class=\"preview-pane\" id=\"preview-pane\">\n                    <div class=\"split-title\">é¢„è§ˆåŒº</div>\n                    <div class=\"preview-body\" id=\"preview-body\"></div>\n                    <div class=\"status-bar\">å®æ—¶æ¸²æŸ“ Â· Mermaid / Prism æ”¯æŒ</div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js\"></script>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/marked@9.1.6/marked.min.js\"></script>\n    <script src=\"js/renderer.js\"></script>\n    <script src=\"js/fileTree.js\"></script>\n    <script src=\"js/editor.js\"></script>\n</body>\n</html>\n<!-- AIGC END -->", type: "text/html; charset=utf-8" },
  "/index.html": { content: "<!DOCTYPE html>\n<html lang=\"zh-CN\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Markdown Viewer</title>\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css\">\n    <link rel=\"stylesheet\" href=\"css/main.css\">\n    <link rel=\"stylesheet\" href=\"css/themes.css\">\n</head>\n<body>\n    <div class=\"app\">\n        <!-- é¡¶éƒ¨å¯¼èˆªæ  -->\n        <header class=\"header\">\n            <div class=\"header-left\">\n                <button class=\"mobile-menu-toggle\" id=\"mobile-menu-toggle\" title=\"èœå•\">\n                    <span class=\"menu-icon\">â˜°</span>\n                </button>\n                <button class=\"sidebar-toggle\" id=\"sidebar-toggle\" title=\"æ”¶èµ·/å±•å¼€æ–‡ä»¶æµè§ˆå™¨\">\n                    <span class=\"sidebar-icon\">â—€</span>\n                </button>\n                <h1>Markdown Viewer</h1>\n                <nav class=\"breadcrumb\" id=\"breadcrumb\">\n                    <span class=\"breadcrumb-item\">æ ¹ç›®å½•</span>\n                </nav>\n            </div>\n            <div class=\"header-right\">\n                <button class=\"theme-toggle\" id=\"theme-toggle\" title=\"åˆ‡æ¢ä¸»é¢˜\">\n                    <span class=\"theme-icon\">ğŸŒ™</span>\n                </button>\n            </div>\n        </header>\n\n        <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->\n        <div class=\"main-container\">\n            <!-- å·¦ä¾§è¾¹æ  -->\n            <aside class=\"sidebar\" id=\"sidebar\">\n                <div class=\"sidebar-header\">\n                    <h3>æ–‡ä»¶æµè§ˆå™¨</h3>\n                    <button class=\"refresh-btn\" id=\"refresh-files\" title=\"åˆ·æ–°æ–‡ä»¶åˆ—è¡¨\">ğŸ”„</button>\n                </div>\n                <div class=\"file-tree\" id=\"file-tree\">\n                    <div class=\"loading\">åŠ è½½ä¸­...</div>\n                </div>\n\n                <!-- æ–°å»ºæ–‡ä»¶å¼¹çª— -->\n                <div id=\"newfile-modal\" class=\"modal-backdrop\" style=\"display:none;\">\n                    <div class=\"modal\">\n                        <div class=\"modal-header\">æ–°å»º Markdown æ–‡ä»¶</div>\n                        <div class=\"modal-body\">\n                            <div class=\"tree-pane\">\n                                <div id=\"newfile-tree\"></div>\n                            </div>\n                            <div class=\"form-pane\">\n                                <label for=\"newfile-dir\">ç›®æ ‡ç›®å½•</label>\n                                <input id=\"newfile-dir\" type=\"text\" placeholder=\"ä¾‹å¦‚ï¼šdocs/notes\" />\n                                <label for=\"newfile-name\">æ–‡ä»¶å</label>\n                                <input id=\"newfile-name\" type=\"text\" placeholder=\"ä¾‹å¦‚ï¼šnew-file.md\" />\n                                <small>ä»…æ”¯æŒ .md/.markdown/.mdown/.mkd/.mkdn</small>\n                            </div>\n                        </div>\n                        <div class=\"modal-footer\">\n                            <button id=\"newfile-cancel\" class=\"edit-btn\">å–æ¶ˆ</button>\n                            <button id=\"newfile-confirm\" class=\"edit-btn\">åˆ›å»º</button>\n                        </div>\n                    </div>\n                </div>\n            </aside>\n            \n            <!-- ä¾§è¾¹æ æ”¶èµ·æ—¶çš„ç¼©ç•¥æ¡ -->\n            <div class=\"sidebar-collapsed\" id=\"sidebar-collapsed\" style=\"display: none;\">\n                <button class=\"sidebar-toggle-collapsed\" id=\"sidebar-toggle-collapsed\" title=\"å±•å¼€æ–‡ä»¶æµè§ˆå™¨\">\n                    <span class=\"sidebar-icon\">â–¶</span>\n                </button>\n                <div class=\"sidebar-collapsed-title\">æ–‡ä»¶</div>\n            </div>\n\n            <!-- ä¸­é—´å¤§çº²åŒºåŸŸ -->\n            <div class=\"outline-panel\" id=\"outline-panel\">\n                <div class=\"outline-header\">\n                    <h3>æ–‡æ¡£å¤§çº²</h3>\n                    <button class=\"toggle-outline\" id=\"toggle-outline\" title=\"æ”¶èµ·å¤§çº²\">â—€</button>\n                </div>\n                <div class=\"outline-content\" id=\"outline-content\">\n                    <div class=\"placeholder\">é€‰æ‹©æ–‡ä»¶æŸ¥çœ‹å¤§çº²</div>\n                </div>\n            </div>\n\n            <!-- å³ä¾§æ¸²æŸ“åŒºåŸŸ -->\n            <main class=\"content-area\">\n                <div class=\"content-header\">\n                    <h2 id=\"content-title\">æ¬¢è¿ä½¿ç”¨ Markdown Viewer</h2>\n                    <div class=\"content-actions\">\n                        <button class=\"edit-btn\" id=\"edit-file\" title=\"ç¼–è¾‘æ–‡ä»¶\">âœï¸</button>\n                        <button class=\"refresh-content\" id=\"refresh-content\" title=\"åˆ·æ–°å†…å®¹\">ğŸ”„</button>\n                    </div>\n                </div>\n                <div class=\"content-body\" id=\"content-body\">\n                    <div class=\"welcome-message\">\n                        <h2>ğŸ“ Markdown Viewer</h2>\n                        <p>ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ Markdown æ–‡ä»¶é¢„è§ˆå™¨</p>\n                        <div class=\"features\">\n                            <h3>âœ¨ åŠŸèƒ½ç‰¹æ€§</h3>\n                            <ul>\n                                <li>ğŸ“ æ–‡ä»¶æ ‘æµè§ˆ</li>\n                                <li>ğŸ¯ æ–‡æ¡£å¤§çº²å¯¼èˆª</li>\n                                <li>ğŸ¨ å¤šä¸»é¢˜æ”¯æŒ</li>\n                                <li>ğŸ“Š Mermaid æµç¨‹å›¾</li>\n                                <li>ğŸŒ¿ PlantUML å›¾è¡¨</li>\n                                <li>âš¡ å®æ—¶æ›´æ–°</li>\n                            </ul>\n                        </div>\n                        <p class=\"tip\">ç‚¹å‡»å·¦ä¾§æ–‡ä»¶æ ‘ä¸­çš„ Markdown æ–‡ä»¶å¼€å§‹æµè§ˆ</p>\n                    </div>\n                </div>\n            </main>\n        </div>\n    </div>\n\n    <!-- è„šæœ¬æ–‡ä»¶ -->\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js\"></script>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/marked@9.1.6/marked.min.js\"></script>\n    <script src=\"js/renderer.js\"></script>\n    <script src=\"js/fileTree.js\"></script>\n    <script src=\"js/app.js\"></script>\n</body>\n</html>", type: "text/html; charset=utf-8" },
  "/js/app.js": { content: "class MarkdownViewerApp {\n    constructor() {\n        this.fileTree = null;\n        this.renderer = null;\n        this.currentFile = null;\n        this.outlineVisible = true;\n        this.sidebarCollapsed = false;\n        this.themes = ['light', 'dark', 'blue', 'green', 'purple'];\n        this.currentTheme = 0;\n        this.websocket = null;\n        this.init();\n    }\n\n    init() {\n        this.setupTheme();\n        this.setupRenderer();\n        this.setupFileTree();\n        this.setupWebSocket();\n        this.setupEventListeners();\n        this.loadInitialFile();\n    }\n\n    setupTheme() {\n        const savedTheme = localStorage.getItem('markdown-viewer-theme') || 'light';\n        this.currentTheme = this.themes.indexOf(savedTheme) >= 0 ? this.themes.indexOf(savedTheme) : 0;\n        this.applyTheme();\n        \n        // æ¢å¤ä¾§è¾¹æ çŠ¶æ€\n        const savedSidebarState = localStorage.getItem('sidebar-collapsed');\n        if (savedSidebarState === 'true') {\n            this.sidebarCollapsed = true;\n            // å»¶è¿Ÿæ‰§è¡Œï¼Œç¡®ä¿DOMå®Œå…¨åŠ è½½\n            setTimeout(() => {\n                this.toggleSidebar();\n            }, 100);\n        }\n    }\n\n    setupRenderer() {\n        this.renderer = new MarkdownRenderer();\n    }\n\n    setupFileTree() {\n        this.fileTree = new FileTree();\n        this.fileTree.onFileSelect = (file) => {\n            this.loadFile(file);\n        };\n    }\n\n    setupWebSocket() {\n        try {\n            this.websocket = new WebSocket('ws://localhost:8080');\n            \n            this.websocket.onopen = () => {\n                console.log('WebSocket connected');\n            };\n            \n            this.websocket.onmessage = (event) => {\n                const message = JSON.parse(event.data);\n                this.handleWebSocketMessage(message);\n            };\n            \n            this.websocket.onclose = () => {\n                console.log('WebSocket disconnected');\n                setTimeout(() => this.setupWebSocket(), 5000);\n            };\n            \n            this.websocket.onerror = (error) => {\n                console.error('WebSocket error:', error);\n            };\n        } catch (error) {\n            console.error('Failed to connect WebSocket:', error);\n        }\n    }\n\n    handleWebSocketMessage(message) {\n        if (message.type === 'file-change' && this.currentFile) {\n            const changedFile = message.data.path;\n            if (changedFile.includes(this.currentFile.path)) {\n                this.loadFile(this.currentFile, true);\n            }\n        }\n    }\n\n    setupEventListeners() {\n        document.getElementById('theme-toggle').addEventListener('click', () => {\n            this.cycleTheme();\n        });\n\n        document.getElementById('toggle-outline').addEventListener('click', () => {\n            this.toggleOutline();\n        });\n\n        document.getElementById('refresh-content').addEventListener('click', () => {\n            if (this.currentFile) {\n                this.loadFile(this.currentFile, true);\n            }\n        });\n\n        document.getElementById('edit-file').addEventListener('click', () => {\n            this.editCurrentFile();\n        });\n\n        // ä¾§è¾¹æ æŠ½å±‰æ•ˆæœæ§åˆ¶\n        const sidebarToggle = document.getElementById('sidebar-toggle');\n        if (sidebarToggle) {\n            sidebarToggle.addEventListener('click', () => {\n                this.toggleSidebar();\n            });\n        }\n\n        const sidebarToggleCollapsed = document.getElementById('sidebar-toggle-collapsed');\n        if (sidebarToggleCollapsed) {\n            sidebarToggleCollapsed.addEventListener('click', () => {\n                this.toggleSidebar();\n            });\n        }\n\n        // ç§»åŠ¨ç«¯èœå•åˆ‡æ¢\n        const mobileMenuToggle = document.getElementById('mobile-menu-toggle');\n        if (mobileMenuToggle) {\n            mobileMenuToggle.addEventListener('click', () => {\n                this.toggleMobileMenu();\n            });\n        }\n\n        document.addEventListener('keydown', (e) => {\n            if (e.ctrlKey || e.metaKey) {\n                switch (e.key) {\n                    case 'r':\n                        e.preventDefault();\n                        if (this.currentFile) {\n                            this.loadFile(this.currentFile, true);\n                        }\n                        break;\n                    case 'e':\n                        e.preventDefault();\n                        this.editCurrentFile();\n                        break;\n                    case 't':\n                        e.preventDefault();\n                        this.cycleTheme();\n                        break;\n                    case 'b':\n                        e.preventDefault();\n                        this.toggleSidebar();\n                        break;\n                }\n            } else if (e.key === 'Escape') {\n                // ESCé”®å…³é—­ç§»åŠ¨ç«¯èœå•\n                this.closeMobileMenu();\n            }\n        });\n\n        window.addEventListener('resize', () => {\n            this.handleResize();\n        });\n    }\n\n    async loadFile(file, force = false) {\n        if (!file || (this.currentFile && this.currentFile.path === file.path && !force)) {\n            return;\n        }\n\n        try {\n            this.currentFile = file;\n            this.fileTree.setCurrentFile(file);\n            this.fileTree.updateBreadcrumb(file.path);\n            \n            // ç§»åŠ¨ç«¯é€‰æ‹©æ–‡ä»¶åå…³é—­èœå•\n            if (window.innerWidth <= 640) {\n                this.closeMobileMenu();\n            }\n            \n            document.getElementById('content-title').textContent = file.name;\n            document.getElementById('content-body').innerHTML = '<div class=\"loading\">åŠ è½½ä¸­...</div>';\n            \n            const response = await fetch(`/api/file/${encodeURIComponent(file.path)}`);\n            const data = await response.json();\n            \n            // ä½¿ç”¨æœåŠ¡å™¨è¿”å›çš„å¤§çº²æ•°æ®ï¼Œç¡®ä¿IDä¸€è‡´æ€§\n            await this.renderer.renderContent(data.content);\n            this.renderOutline(data.outline);\n            \n            this.scrollToTop();\n        } catch (error) {\n            console.error('Error loading file:', error);\n            document.getElementById('content-body').innerHTML = `\n                <div class=\"error\">\n                    <h3>åŠ è½½æ–‡ä»¶å¤±è´¥</h3>\n                    <p>${error.message}</p>\n                </div>\n            `;\n        }\n    }\n\n    renderOutline(outline) {\n        console.log('Rendering outline:', outline);\n        const container = document.getElementById('outline-content');\n        \n        if (!outline || outline.length === 0) {\n            container.innerHTML = '<div class=\"placeholder\">æ— å¤§çº²ä¿¡æ¯</div>';\n            return;\n        }\n\n        container.innerHTML = '';\n        outline.forEach((item, index) => {\n            console.log('Creating outline item:', item);\n            const element = document.createElement('div');\n            element.className = `outline-item level-${item.level}`;\n            element.textContent = item.text;\n            element.title = item.text;\n            element.setAttribute('data-heading-id', item.id);\n            element.style.cursor = 'pointer';\n            element.style.paddingLeft = `${(item.level - 1) * 16 + 8}px`;\n            \n            element.addEventListener('click', () => {\n                console.log('Outline item clicked:', item.id, item.text);\n                this.scrollToHeading(item.id);\n            });\n            \n            // æ·»åŠ æ‚¬åœæ•ˆæœ\n            element.addEventListener('mouseenter', () => {\n                element.style.backgroundColor = 'var(--hover-color, rgba(0, 123, 255, 0.1))';\n            });\n            \n            element.addEventListener('mouseleave', () => {\n                element.style.backgroundColor = '';\n            });\n            \n            container.appendChild(element);\n        });\n    }\n\n    scrollToHeading(id) {\n        console.log('Attempting to scroll to heading with ID:', id);\n        const heading = document.getElementById(id);\n        if (heading) {\n            console.log('Found heading, scrolling to:', id);\n            // ç¡®ä¿åœ¨æ­£ç¡®çš„å®¹å™¨å†…æ»šåŠ¨\n            const contentBody = document.getElementById('content-body');\n            const headingTop = heading.offsetTop;\n            contentBody.scrollTo({ top: headingTop - 20, behavior: 'smooth' });\n            \n            // é«˜äº®æ˜¾ç¤ºç›®æ ‡æ ‡é¢˜\n            heading.style.backgroundColor = 'var(--accent-color, #007bff)';\n            heading.style.color = 'white';\n            heading.style.padding = '2px 8px';\n            heading.style.borderRadius = '4px';\n            heading.style.transition = 'all 0.3s ease';\n            \n            // 2ç§’åç§»é™¤é«˜äº®\n            setTimeout(() => {\n                heading.style.backgroundColor = '';\n                heading.style.color = '';\n                heading.style.padding = '';\n                heading.style.borderRadius = '';\n            }, 2000);\n        } else {\n            console.warn('Heading not found with ID:', id);\n            // å°è¯•æŸ¥æ‰¾æ‰€æœ‰æ ‡é¢˜å…ƒç´ \n            const allHeadings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');\n            console.log('Available headings:', Array.from(allHeadings).map(h => ({ id: h.id, text: h.textContent })));\n        }\n    }\n\n    scrollToTop() {\n        document.getElementById('content-body').scrollTop = 0;\n    }\n\n    cycleTheme() {\n        this.currentTheme = (this.currentTheme + 1) % this.themes.length;\n        this.applyTheme();\n    }\n\n    applyTheme() {\n        const theme = this.themes[this.currentTheme];\n        document.documentElement.setAttribute('data-theme', theme);\n        localStorage.setItem('markdown-viewer-theme', theme);\n        \n        const icon = document.querySelector('.theme-icon');\n        const themeIcons = {\n            light: 'â˜€ï¸',\n            dark: 'ğŸŒ™',\n            blue: 'ğŸ”µ',\n            green: 'ğŸŸ¢',\n            purple: 'ğŸŸ£'\n        };\n        \n        if (icon) {\n            icon.textContent = themeIcons[theme] || 'ğŸŒ™';\n        }\n        \n        // æ›´æ–°æŒ‰é’®æ ‡é¢˜\n        const themeToggle = document.getElementById('theme-toggle');\n        if (themeToggle) {\n            const themeNames = {\n                light: 'äº®è‰²ä¸»é¢˜',\n                dark: 'æš—è‰²ä¸»é¢˜',\n                blue: 'è“è‰²ä¸»é¢˜',\n                green: 'ç»¿è‰²ä¸»é¢˜',\n                purple: 'ç´«è‰²ä¸»é¢˜'\n            };\n            themeToggle.title = `åˆ‡æ¢åˆ°${themeNames[theme] || 'é»˜è®¤ä¸»é¢˜'}`;\n        }\n        \n        if (typeof mermaid !== 'undefined') {\n            const isDark = theme === 'dark';\n            mermaid.initialize({\n                theme: isDark ? 'dark' : 'default',\n                themeVariables: {\n                    darkMode: isDark,\n                    primaryColor: isDark ? '#4dabf7' : '#007bff',\n                    primaryTextColor: isDark ? '#ffffff' : '#ffffff',\n                    primaryBorderColor: isDark ? '#339af0' : '#0056b3',\n                    lineColor: isDark ? '#b0b0b0' : '#6c757d'\n                }\n            });\n        }\n    }\n\n    toggleOutline() {\n        const panel = document.getElementById('outline-panel');\n        const toggle = document.getElementById('toggle-outline');\n        const contentArea = document.querySelector('.content-area');\n        const expandedWidth = 250;\n        const collapsedWidth = 40;\n\n        this.outlineVisible = !this.outlineVisible;\n\n        if (this.outlineVisible) {\n            // å±•å¼€æ—¶ï¼šç§»é™¤ collapsedï¼Œæ·»åŠ  openï¼ˆåœ¨ç§»åŠ¨ç«¯ç¡®ä¿ä»å±å¹•å¤–æ»‘å…¥ï¼‰\n            panel.classList.remove('collapsed');\n            panel.classList.add('open');\n            panel.style.width = expandedWidth + 'px';\n            panel.style.display = 'flex';\n            panel.style.transition = 'width 0.3s ease';\n            toggle.textContent = 'â—€';\n            toggle.title = 'æ”¶èµ·å¤§çº²';\n        } else {\n            // æ”¶èµ·æ—¶ï¼šç§»é™¤ openï¼Œæ·»åŠ  collapsedï¼ˆç§»åŠ¨ç«¯ä¿ç•™æŠŠæ‰‹å¯ç‚¹å‡»ï¼‰\n            panel.classList.remove('open');\n            panel.classList.add('collapsed');\n            panel.style.width = collapsedWidth + 'px';\n            panel.style.display = 'flex';\n            panel.style.transition = 'width 0.3s ease';\n            toggle.textContent = 'â–¶';\n            toggle.title = 'å±•å¼€å¤§çº²';\n        }\n    }\n\n    toggleSidebar() {\n        this.sidebarCollapsed = !this.sidebarCollapsed;\n        const sidebar = document.getElementById('sidebar');\n        const collapsedBar = document.getElementById('sidebar-collapsed');\n        const mainContainer = document.querySelector('.main-container');\n        const toggle = document.getElementById('sidebar-toggle');\n        const toggleCollapsed = document.getElementById('sidebar-toggle-collapsed');\n        \n        if (this.sidebarCollapsed) {\n            // æ”¶èµ·ä¾§è¾¹æ \n            sidebar.style.width = '0';\n            sidebar.style.padding = '0';\n            sidebar.style.overflow = 'hidden';\n            sidebar.style.transition = 'all 0.3s ease';\n            \n            collapsedBar.style.display = 'flex';\n            mainContainer.style.marginLeft = '40px'; // ç¼©ç•¥æ¡å®½åº¦\n            \n            if (toggle) {\n                toggle.innerHTML = '<span class=\"sidebar-icon\">â–¶</span>';\n                toggle.title = 'å±•å¼€æ–‡ä»¶æµè§ˆå™¨';\n            }\n            \n            // ä¿å­˜çŠ¶æ€åˆ°æœ¬åœ°å­˜å‚¨\n            localStorage.setItem('sidebar-collapsed', 'true');\n        } else {\n            // å±•å¼€ä¾§è¾¹æ \n            sidebar.style.width = '300px';\n            sidebar.style.padding = '16px';\n            sidebar.style.overflow = 'auto';\n            sidebar.style.transition = 'all 0.3s ease';\n            \n            collapsedBar.style.display = 'none';\n            mainContainer.style.marginLeft = '0';\n            \n            if (toggle) {\n                toggle.innerHTML = '<span class=\"sidebar-icon\">â—€</span>';\n                toggle.title = 'æ”¶èµ·æ–‡ä»¶æµè§ˆå™¨';\n            }\n            \n            // ä¿å­˜çŠ¶æ€åˆ°æœ¬åœ°å­˜å‚¨\n            localStorage.setItem('sidebar-collapsed', 'false');\n        }\n        \n        // è§¦å‘çª—å£å¤§å°å˜åŒ–äº‹ä»¶ï¼Œè®©å…¶ä»–ç»„ä»¶é‡æ–°è®¡ç®—å¸ƒå±€\n        window.dispatchEvent(new Event('resize'));\n    }\n\n    editCurrentFile() {\n        if (this.currentFile) {\n            const filePath = this.currentFile.path;\n            const returnUrl = window.location.pathname + window.location.search;\n            const editUrl = `/editor.html?file=${encodeURIComponent(filePath)}&return=${encodeURIComponent(returnUrl)}`;\n            \n            try {\n                window.location.href = editUrl;\n            } catch (error) {\n                console.error('Failed to open editor page:', error);\n                alert('æ— æ³•æ‰“å¼€ç¼–è¾‘å™¨é¡µé¢ï¼Œè¯·æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦è¿è¡Œ');\n            }\n        }\n    }\n\n    handleResize() {\n        const width = window.innerWidth;\n        const panel = document.getElementById('outline-panel');\n        const contentArea = document.querySelector('.content-area');\n        const expandedWidth = 250;\n        const collapsedWidth = 40;\n\n        if (width <= 640) {\n            // ä¿æŒå¯ç‚¹å‡»æŠŠæ‰‹å¯è§ï¼ˆä¸å†ä½¿ç”¨ display:noneï¼‰\n            this.outlineVisible = false;\n            panel.classList.add('collapsed');\n            panel.style.display = 'flex';\n            panel.style.width = collapsedWidth + 'px';\n            if (contentArea) {\n                contentArea.style.marginLeft = collapsedWidth + 'px';\n            }\n\n            // ç§»åŠ¨ç«¯å¼ºåˆ¶å±•å¼€ä¾§è¾¹æ ï¼ˆä½¿ç”¨ç§»åŠ¨ç«¯èœå•é€»è¾‘ï¼‰\n            if (this.sidebarCollapsed) {\n                this.sidebarCollapsed = false;\n                const sidebar = document.getElementById('sidebar');\n                const collapsedBar = document.getElementById('sidebar-collapsed');\n                const mainContainer = document.querySelector('.main-container');\n                \n                sidebar.classList.remove('collapsed');\n                collapsedBar.style.display = 'none';\n                mainContainer.classList.remove('sidebar-collapsed');\n            }\n        } else {\n            // æ¡Œé¢ç«¯ä¿æŒæŠ½å±‰çŠ¶æ€ä¸æŒ‰é’®å¯è§\n            panel.style.display = 'flex';\n            if (this.outlineVisible) {\n                panel.classList.remove('collapsed');\n                panel.style.width = expandedWidth + 'px';\n                if (contentArea) {\n                    contentArea.style.marginLeft = expandedWidth + 'px';\n                }\n            } else {\n                panel.classList.add('collapsed');\n                panel.style.width = collapsedWidth + 'px';\n                if (contentArea) {\n                    contentArea.style.marginLeft = collapsedWidth + 'px';\n                }\n            }\n\n            // æ¡Œé¢ç«¯æ¢å¤ä¾§æ æŠ½å±‰çŠ¶æ€\n            const savedSidebarState = localStorage.getItem('sidebar-collapsed');\n            const shouldBeCollapsed = savedSidebarState === 'true';\n            if (shouldBeCollapsed !== this.sidebarCollapsed) {\n                this.toggleSidebar();\n            }\n        }\n    }\n\n    toggleMobileMenu() {\n        const sidebar = document.querySelector('.sidebar');\n        const overlay = document.querySelector('.mobile-menu-overlay');\n        \n        if (!overlay) {\n            // åˆ›å»ºé®ç½©å±‚\n            const newOverlay = document.createElement('div');\n            newOverlay.className = 'mobile-menu-overlay';\n            document.body.appendChild(newOverlay);\n            \n            newOverlay.addEventListener('click', () => {\n                this.closeMobileMenu();\n            });\n        }\n        \n        const currentOverlay = document.querySelector('.mobile-menu-overlay');\n        \n        if (sidebar.classList.contains('open')) {\n            this.closeMobileMenu();\n        } else {\n            sidebar.classList.add('open');\n            currentOverlay.classList.add('active');\n            document.body.style.overflow = 'hidden';\n        }\n    }\n\n    closeMobileMenu() {\n        const sidebar = document.querySelector('.sidebar');\n        const overlay = document.querySelector('.mobile-menu-overlay');\n        \n        sidebar.classList.remove('open');\n        if (overlay) {\n            overlay.classList.remove('active');\n        }\n        document.body.style.overflow = '';\n    }\n\n    async loadInitialFile() {\n        // å°è¯•ä»URLå‚æ•°åŠ è½½æ–‡ä»¶\n        const urlParams = new URLSearchParams(window.location.search);\n        const filePath = urlParams.get('file');\n        \n        if (filePath) {\n            try {\n                const response = await fetch(`/api/file/${encodeURIComponent(filePath)}`);\n                if (response.ok) {\n                    const file = { name: filePath.split('/').pop(), path: filePath };\n                    this.loadFile(file);\n                }\n            } catch (error) {\n                console.error('Error loading initial file:', error);\n            }\n        }\n    }\n}\n\ndocument.addEventListener('DOMContentLoaded', () => {\n    window.markdownViewer = new MarkdownViewerApp();\n});", type: "application/javascript; charset=utf-8" },
  "/js/editor.js": { content: "// AIGC START\n(function(){\n  const $ = (id) => document.getElementById(id);\n  const qs = (s) => document.querySelector(s);\n\n  const params = new URLSearchParams(window.location.search);\n  const filePath = params.get('file');\n  let originUrl = params.get('return');\n\n  let renderer;\n  let renderDebounce;\n  const renderDelay = 250;\n\n  function setStatus(text){\n    const s = $('status');\n    if(s) s.textContent = text;\n  }\n\n  function applyThemeFromViewer(){\n    const saved = localStorage.getItem('markdown-viewer-theme') || 'light';\n    document.documentElement.setAttribute('data-theme', saved);\n  }\n\n  let lastModified = undefined;\n  async function loadFile(){\n    if(!filePath) return;\n    try{\n      $('editor-title').textContent = `ç¼–è¾‘ï¼š${filePath}`;\n      const res = await fetch(`/api/file/${encodeURIComponent(filePath)}`);\n      if(!res.ok){ throw new Error(`åŠ è½½å¤±è´¥ï¼š${res.status}`); }\n      const data = await res.json();\n      $('editor-textarea').value = data.content || '';\n      lastModified = data.lastModified;\n      scheduleRender();\n      setStatus('å·²åŠ è½½');\n    }catch(err){\n      console.error(err);\n      setStatus('åŠ è½½å¤±è´¥');\n    }\n  }\n\n  function scheduleRender(){\n    clearTimeout(renderDebounce);\n    renderDebounce = setTimeout(renderPreview, renderDelay);\n  }\n\n  async function renderPreview(){\n    try{\n      const pane = $('preview-pane');\n      if (pane && pane.classList.contains('hidden')) return; // é¢„è§ˆéšè—æ—¶è·³è¿‡æ¸²æŸ“\n      const content = $('editor-textarea').value;\n      const outline = await renderer.renderContent(content, 'preview-body');\n      // ä¸ä½¿ç”¨ outlineï¼Œè¿™é‡Œåªè´Ÿè´£æ¸²æŸ“\n    }catch(err){\n      console.error('é¢„è§ˆæ¸²æŸ“å¤±è´¥', err);\n    }\n  }\n\n  function surroundSelection(prefix, suffix){\n    const ta = $('editor-textarea');\n    const start = ta.selectionStart, end = ta.selectionEnd;\n    const before = ta.value.slice(0, start);\n    const sel = ta.value.slice(start, end);\n    const after = ta.value.slice(end);\n    ta.value = before + prefix + sel + suffix + after;\n    ta.selectionStart = start + prefix.length;\n    ta.selectionEnd = end + prefix.length;\n    ta.focus();\n    scheduleRender();\n    unsaved = true;\n  }\n\n  function insertAtLineStart(prefix){\n    const ta = $('editor-textarea');\n    const pos = ta.selectionStart;\n    const value = ta.value;\n    const lineStart = value.lastIndexOf('\\n', pos - 1) + 1;\n    ta.value = value.slice(0, lineStart) + prefix + value.slice(lineStart);\n    ta.selectionStart = ta.selectionEnd = pos + prefix.length;\n    ta.focus();\n    scheduleRender();\n    unsaved = true;\n  }\n\n  function bindShortcuts(){\n    document.addEventListener('keydown', (e)=>{\n      const key = e.key.toLowerCase();\n      if((e.metaKey || e.ctrlKey) && key === 's'){\n        e.preventDefault();\n        saveFile();\n      }\n      if((e.metaKey || e.ctrlKey) && key === 'b'){\n        e.preventDefault();\n        surroundSelection('**', '**');\n      }\n      if((e.metaKey || e.ctrlKey) && key === 'i'){\n        e.preventDefault();\n        surroundSelection('*', '*');\n      }\n      if((e.metaKey || e.ctrlKey) && /[1-6]/.test(key)){\n        e.preventDefault();\n        insertAtLineStart('#'.repeat(parseInt(key)) + ' ');\n      }\n    });\n  }\n\n  async function saveFile(targetPath){\n    try{\n      const pathToSave = targetPath || filePath;\n      if(!pathToSave){ return; }\n      const content = $('editor-textarea').value;\n      const res = await fetch(`/api/file/${encodeURIComponent(pathToSave)}`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ content, lastModified })\n      });\n      let data;\n      try {\n        data = await res.json();\n      } catch (e) {\n        const text = await res.text();\n        throw new Error(`ä¿å­˜å¤±è´¥ï¼ˆ${res.status}ï¼‰ï¼š${text.slice(0,200)}`);\n      }\n      if(!res.ok || !data.success){\n        if (res.status === 409) {\n          openOverrideModal(pathToSave);\n          return;\n        }\n        throw new Error(data.error || `ä¿å­˜å¤±è´¥ï¼ˆ${res.status}ï¼‰`);\n      }\n      lastModified = data.lastModified;\n      setStatus('å·²ä¿å­˜');\n      unsaved = false;\n    }catch(err){\n      console.error('ä¿å­˜é”™è¯¯', err);\n      alert(err.message || 'ä¿å­˜å¤±è´¥');\n      setStatus('ä¿å­˜å¤±è´¥');\n    }\n  }\n\n  function openOverrideModal(target){\n    const b = $('override-modal');\n    b.style.display = 'flex';\n    b.dataset.target = target;\n  }\n  function closeOverrideModal(){\n    const b = $('override-modal');\n    b.style.display = 'none';\n    delete b.dataset.target;\n  }\n  async function confirmOverride(){\n    const b = $('override-modal');\n    const target = b.dataset.target || filePath;\n    const content = $('editor-textarea').value;\n    const res = await fetch(`/api/file/${encodeURIComponent(target)}`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ content, override: true })\n    });\n    const data = await res.json();\n    if(!res.ok || !data.success){\n      alert(data.error || `è¦†ç›–ä¿å­˜å¤±è´¥ï¼ˆ${res.status}ï¼‰`);\n      return;\n    }\n    lastModified = data.lastModified;\n    setStatus('å·²ä¿å­˜');\n    unsaved = false;\n    closeOverrideModal();\n  }\n\n  async function openSaveAsModal(){\n    const backdrop = $('saveas-modal');\n    backdrop.style.display = 'flex';\n    // åŠ è½½æ–‡ä»¶æ ‘\n    try {\n      const res = await fetch('/api/files');\n      const files = await res.json();\n      renderSaveAsTree(files);\n    } catch (e) {\n      console.error('åŠ è½½æ–‡ä»¶æ ‘å¤±è´¥', e);\n      $('saveas-tree').innerHTML = '<div class=\"error\">åŠ è½½æ–‡ä»¶æ ‘å¤±è´¥</div>';\n    }\n  }\n\n  function closeSaveAsModal(){\n    const backdrop = $('saveas-modal');\n    backdrop.style.display = 'none';\n  }\n\n  function renderSaveAsTree(files){\n    const container = $('saveas-tree');\n    container.innerHTML = '';\n\n    function createItem(node, level){\n      const el = document.createElement('div');\n      el.className = 'tree-item';\n      el.style.paddingLeft = `${level * 1.25 + 0.5}rem`;\n      el.textContent = (node.type === 'directory' ? 'ğŸ“ ' : 'ğŸ“„ ') + node.name;\n      el.dataset.path = node.path || '';\n      el.dataset.type = node.type;\n      el.addEventListener('click', ()=>{\n        // ä»…å…è®¸é€‰æ‹©ç›®å½•ä½œä¸ºç›®æ ‡ç›®å½•\n        container.querySelectorAll('.tree-item').forEach(i=> i.classList.remove('selected'));\n        el.classList.add('selected');\n        if (node.type === 'directory') {\n          $('saveas-dir').value = node.path || '';\n        } else {\n          const dir = node.path ? node.path.replace(/\\/[^\\/]+$/, '') : '';\n          $('saveas-dir').value = dir;\n          $('saveas-name').value = node.name;\n        }\n      });\n      return el;\n    }\n\n    function traverse(nodes, level){\n      nodes.forEach(n => {\n        container.appendChild(createItem(n, level));\n        if (n.type === 'directory' && n.children && n.children.length) {\n          traverse(n.children, level + 1);\n        }\n      });\n    }\n\n    traverse(files, 0);\n  }\n\n  async function confirmSaveAs(){\n    const dir = $('saveas-dir').value.trim();\n    const name = $('saveas-name').value.trim();\n    if (!name) { alert('è¯·è¾“å…¥æ–‡ä»¶å'); return; }\n    const target = dir ? `${dir.replace(/\\/+$/, '')}/${name}` : name;\n    if(!/\\.(md|markdown|mdown|mkd|mkdn)$/i.test(target)){\n      alert('ä»…æ”¯æŒä¿å­˜ä¸º Markdown æ–‡ä»¶');\n      return;\n    }\n    await saveFile(target);\n    const url = new URL(window.location.href);\n    url.searchParams.set('file', target);\n    history.replaceState(null, '', url.toString());\n    $('editor-title').textContent = `ç¼–è¾‘ï¼š${target}`;\n    closeSaveAsModal();\n  }\n\n  function saveAs(){\n    openSaveAsModal();\n  }\n\n  function togglePreview(){\n    const pane = $('preview-pane');\n    pane.classList.toggle('hidden');\n    const hidden = pane.classList.contains('hidden');\n    try { localStorage.setItem('editor-preview-hidden', hidden ? '1' : '0'); } catch {}\n  }\n\n  function goBack(){\n    // è‹¥æä¾› return å‚æ•°ï¼Œä¼˜å…ˆå›åˆ°è¯¥ URLï¼›å¦åˆ™å›åˆ°æ ¹é¢„è§ˆå¹¶æºå¸¦ ?file\n    const previewUrl = originUrl || (`/index.html?file=${encodeURIComponent(filePath || '')}`);\n    if (unsaved) {\n      const ok = confirm('å­˜åœ¨æœªä¿å­˜çš„æ›´æ”¹ï¼Œç¡®å®šè¦è¿”å›å—ï¼Ÿ');\n      if (!ok) return;\n    }\n    window.location.href = previewUrl;\n  }\n\n  let unsaved = false;\n\n  function bindUI(){\n    $('editor-textarea').addEventListener('input', ()=>{ unsaved = true; scheduleRender(); });\n    $('btn-save').addEventListener('click', ()=> { saveFile(); unsaved = false; });\n    $('btn-save-as').addEventListener('click', ()=> { saveAs(); });\n    $('btn-toggle-preview').addEventListener('click', togglePreview);\n    $('btn-back').addEventListener('click', goBack);\n\n    $('btn-bold').addEventListener('click', ()=> surroundSelection('**','**'));\n    $('btn-italic').addEventListener('click', ()=> surroundSelection('*','*'));\n    $('btn-h1').addEventListener('click', ()=> insertAtLineStart('# '));\n    $('btn-h2').addEventListener('click', ()=> insertAtLineStart('## '));\n    $('btn-h3').addEventListener('click', ()=> insertAtLineStart('### '));\n    $('btn-h4').addEventListener('click', ()=> insertAtLineStart('#### '));\n    $('btn-h5').addEventListener('click', ()=> insertAtLineStart('##### '));\n    $('btn-h6').addEventListener('click', ()=> insertAtLineStart('###### '));\n\n    $('saveas-cancel').addEventListener('click', closeSaveAsModal);\n    $('saveas-confirm').addEventListener('click', confirmSaveAs);\n\n    $('override-cancel').addEventListener('click', closeOverrideModal);\n    $('override-confirm').addEventListener('click', confirmOverride);\n\n    window.addEventListener('beforeunload', (e)=>{\n      if (!unsaved) return;\n      e.preventDefault();\n      e.returnValue = '';\n    });\n  }\n\n  function init(){\n    applyThemeFromViewer();\n    renderer = new MarkdownRenderer();\n\n    const hidden = (localStorage.getItem('editor-preview-hidden') === '1');\n    if (hidden) $('preview-pane').classList.add('hidden');\n\n    bindShortcuts();\n    bindUI();\n    loadFile();\n  }\n\n  document.addEventListener('DOMContentLoaded', init);\n})();\n//AIGC END", type: "application/javascript; charset=utf-8" },
  "/js/fileTree.js": { content: "class FileTree {\n    constructor() {\n        this.container = document.getElementById('file-tree');\n        this.files = [];\n        this.currentFile = null;\n        this.onFileSelect = null;\n        this.contextMenu = null;\n        this.init();\n    }\n\n    init() {\n        this.loadFiles();\n        document.getElementById('refresh-files').addEventListener('click', () => {\n            this.loadFiles();\n        });\n        \n        // æ·»åŠ é”®ç›˜å¯¼èˆªæ”¯æŒ\n        this.setupKeyboardNavigation();\n        \n        // æ·»åŠ å³é”®èœå•æ”¯æŒ\n        this.setupContextMenu();\n    }\n    \n    setupKeyboardNavigation() {\n        this.container.addEventListener('keydown', (e) => {\n            const items = Array.from(this.container.querySelectorAll('.file-tree-item'));\n            const currentIndex = items.findIndex(item => item.classList.contains('focused'));\n            \n            switch (e.key) {\n                case 'ArrowDown':\n                    e.preventDefault();\n                    this.focusItem(items, currentIndex + 1);\n                    break;\n                case 'ArrowUp':\n                    e.preventDefault();\n                    this.focusItem(items, currentIndex - 1);\n                    break;\n                case 'ArrowRight':\n                    e.preventDefault();\n                    this.handleExpand(currentIndex, items);\n                    break;\n                case 'ArrowLeft':\n                    e.preventDefault();\n                    this.handleCollapse(currentIndex, items);\n                    break;\n                case 'Enter':\n                case ' ':\n                    e.preventDefault();\n                    this.handleSelect(currentIndex, items);\n                    break;\n                case 'Home':\n                    e.preventDefault();\n                    this.focusItem(items, 0);\n                    break;\n                case 'End':\n                    e.preventDefault();\n                    this.focusItem(items, items.length - 1);\n                    break;\n            }\n        });\n        \n        // ä½¿æ–‡ä»¶æ ‘å¯ä»¥è·å¾—ç„¦ç‚¹\n        this.container.setAttribute('tabindex', '0');\n    }\n    \n    focusItem(items, index) {\n        if (index < 0 || index >= items.length) return;\n        \n        // ç§»é™¤ä¹‹å‰çš„ç„¦ç‚¹\n        items.forEach(item => item.classList.remove('focused'));\n        \n        // æ·»åŠ æ–°çš„ç„¦ç‚¹\n        items[index].classList.add('focused');\n        items[index].focus();\n        \n        // ç¡®ä¿é¡¹ç›®åœ¨è§†å›¾ä¸­\n        items[index].scrollIntoView({ block: 'nearest' });\n    }\n    \n    handleExpand(currentIndex, items) {\n        if (currentIndex < 0 || currentIndex >= items.length) return;\n        \n        const item = items[currentIndex];\n        const fileData = this.findFileDataByElement(item);\n        \n        if (fileData && fileData.type === 'directory') {\n            if (!fileData.expanded) {\n                this.toggleDirectory(fileData, item);\n            } else {\n                // å¦‚æœå·²ç»å±•å¼€ï¼Œç§»åŠ¨åˆ°ç¬¬ä¸€ä¸ªå­é¡¹\n                const nextItem = this.findNextVisibleItem(items, currentIndex);\n                if (nextItem) {\n                    this.focusItem(items, items.indexOf(nextItem));\n                }\n            }\n        }\n    }\n    \n    handleCollapse(currentIndex, items) {\n        if (currentIndex < 0 || currentIndex >= items.length) return;\n        \n        const item = items[currentIndex];\n        const fileData = this.findFileDataByElement(item);\n        \n        if (fileData && fileData.type === 'directory' && fileData.expanded) {\n            this.toggleDirectory(fileData, item);\n        } else {\n            // å¦‚æœä¸æ˜¯ç›®å½•æˆ–å·²æ”¶ç¼©ï¼Œå°è¯•æ‰¾åˆ°çˆ¶é¡¹\n            const parentItem = this.findParentItem(items, currentIndex);\n            if (parentItem) {\n                this.focusItem(items, items.indexOf(parentItem));\n            }\n        }\n    }\n    \n    handleSelect(currentIndex, items) {\n        if (currentIndex < 0 || currentIndex >= items.length) return;\n        \n        const item = items[currentIndex];\n        const fileData = this.findFileDataByElement(item);\n        \n        if (fileData) {\n            if (fileData.type === 'file') {\n                this.selectFile(fileData, item);\n            } else if (fileData.type === 'directory') {\n                this.toggleDirectory(fileData, item);\n            }\n        }\n    }\n    \n    findNextVisibleItem(items, currentIndex) {\n        // ç®€åŒ–çš„å®ç°ï¼šè¿”å›ä¸‹ä¸€ä¸ªé¡¹ç›®\n        return items[currentIndex + 1] || null;\n    }\n    \n    findParentItem(items, currentIndex) {\n        // ç®€åŒ–çš„å®ç°ï¼šæ‰¾åˆ°çº§åˆ«æ›´ä½çš„é¡¹ç›®\n        const currentItem = items[currentIndex];\n        const currentLevel = parseInt(currentItem.getAttribute('data-level')) || 0;\n        \n        for (let i = currentIndex - 1; i >= 0; i--) {\n            const item = items[i];\n            const level = parseInt(item.getAttribute('data-level')) || 0;\n            if (level < currentLevel) {\n                return item;\n            }\n        }\n        return null;\n    }\n    \n    findFileDataByElement(element) {\n        // é€šè¿‡å…ƒç´ æ‰¾åˆ°å¯¹åº”çš„æ–‡ä»¶æ•°æ®\n        const itemText = element.querySelector('.file-name')?.textContent;\n        if (!itemText) return null;\n        \n        return this.findFileDataByName(this.files, itemText);\n    }\n    \n    findFileDataByName(files, name, currentPath = '') {\n        for (const file of files) {\n            if (file.name === name) {\n                return file;\n            }\n            \n            if (file.type === 'directory' && file.children) {\n                const found = this.findFileDataByName(file.children, name, currentPath + '/' + file.name);\n                if (found) return found;\n            }\n        }\n        return null;\n    }\n    \n    setupContextMenu() {\n        // åˆ›å»ºå³é”®èœå•å…ƒç´ \n        this.createContextMenu();\n        \n        // æ·»åŠ å…¨å±€ç‚¹å‡»äº‹ä»¶æ¥å…³é—­èœå•\n        document.addEventListener('click', () => {\n            this.hideContextMenu();\n        });\n        \n        // é˜»æ­¢å³é”®èœå•çš„é»˜è®¤è¡Œä¸º\n        document.addEventListener('contextmenu', (e) => {\n            if (!e.target.closest('.file-tree-item')) {\n                this.hideContextMenu();\n            }\n        });\n    }\n    \n    createContextMenu() {\n        this.contextMenu = document.createElement('div');\n        this.contextMenu.className = 'context-menu';\n        this.contextMenu.style.display = 'none';\n        document.body.appendChild(this.contextMenu);\n    }\n    \n    showContextMenu(event, file) {\n        event.preventDefault();\n        event.stopPropagation();\n        \n        this.hideContextMenu();\n        \n        // æ¸…ç©ºèœå•\n        this.contextMenu.innerHTML = '';\n        \n        // æ·»åŠ èœå•é¡¹\n        if (file.type === 'file') {\n            this.addContextMenuItem('ğŸ“– æ‰“å¼€æ–‡ä»¶', () => {\n                this.selectFile(file, null);\n                this.hideContextMenu();\n            });\n            \n            this.addContextMenuItem('âœï¸ ç¼–è¾‘æ–‡ä»¶', () => {\n                this.editFile(file);\n                this.hideContextMenu();\n            });\n            \n            this.addContextMenuItem('ğŸ“‹ å¤åˆ¶è·¯å¾„', () => {\n                this.copyFilePath(file);\n                this.hideContextMenu();\n            });\n        } else if (file.type === 'directory') {\n            this.addContextMenuItem(file.expanded ? 'ğŸ“ æŠ˜å ç›®å½•' : 'ğŸ“‚ å±•å¼€ç›®å½•', () => {\n                const element = this.findElementByFile(file);\n                if (element) {\n                    this.toggleDirectory(file, element);\n                }\n                this.hideContextMenu();\n            });\n            \n            this.addContextMenuItem('ğŸ”„ åˆ·æ–°ç›®å½•', () => {\n                this.refreshDirectory(file);\n                this.hideContextMenu();\n            });\n        }\n        \n        this.addContextMenuSeparator();\n        \n        this.addContextMenuItem('ğŸ“„ æ–°å»ºæ–‡ä»¶', () => {\n            this.createNewFile(file);\n            this.hideContextMenu();\n        });\n        \n        this.addContextMenuItem('ğŸ“ æ–°å»ºæ–‡ä»¶å¤¹', () => {\n            this.createNewDirectory(file);\n            this.hideContextMenu();\n        });\n        \n        // å®šä½èœå•\n        this.contextMenu.style.left = event.pageX + 'px';\n        this.contextMenu.style.top = event.pageY + 'px';\n        this.contextMenu.style.display = 'block';\n    }\n    \n    addContextMenuItem(label, onClick) {\n        const item = document.createElement('div');\n        item.className = 'context-menu-item';\n        item.textContent = label;\n        item.addEventListener('click', onClick);\n        this.contextMenu.appendChild(item);\n    }\n    \n    addContextMenuSeparator() {\n        const separator = document.createElement('div');\n        separator.className = 'context-menu-separator';\n        this.contextMenu.appendChild(separator);\n    }\n    \n    hideContextMenu() {\n        if (this.contextMenu) {\n            this.contextMenu.style.display = 'none';\n        }\n    }\n    \n    findElementByFile(file) {\n        const items = this.container.querySelectorAll('.file-tree-item');\n        for (const item of items) {\n            const fileName = item.querySelector('.file-name')?.textContent;\n            if (fileName === file.name) {\n                return item;\n            }\n        }\n        return null;\n    }\n    \n    editFile(file) {\n        if (this.onFileSelect) {\n            this.onFileSelect(file);\n        }\n        \n        // è§¦å‘ç¼–è¾‘åŠŸèƒ½\n        const editEvent = new CustomEvent('file-edit', { detail: file });\n        document.dispatchEvent(editEvent);\n    }\n    \n    copyFilePath(file) {\n        const fullPath = file.path;\n        navigator.clipboard.writeText(fullPath).then(() => {\n            this.showNotification('æ–‡ä»¶è·¯å¾„å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');\n        }).catch(() => {\n            // é™çº§æ–¹æ¡ˆ\n            const textArea = document.createElement('textarea');\n            textArea.value = fullPath;\n            document.body.appendChild(textArea);\n            textArea.select();\n            document.execCommand('copy');\n            document.body.removeChild(textArea);\n            this.showNotification('æ–‡ä»¶è·¯å¾„å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');\n        });\n    }\n    \n    refreshDirectory(directory) {\n        this.loadFiles();\n        this.showNotification('ç›®å½•å·²åˆ·æ–°');\n    }\n    \n    async createNewFile(parentFile) {\n        const fileName = prompt('è¯·è¾“å…¥æ–°æ–‡ä»¶åï¼ˆåŒ…å«æ‰©å±•åï¼Œæ”¯æŒ .md/.markdown/.mdown/.mkd/.mkdnï¼‰:');\n        if (!fileName) return;\n        const allowed = ['.md', '.markdown', '.mdown', '.mkd', '.mkdn'];\n        const lower = fileName.toLowerCase();\n        if (!allowed.some(ext => lower.endsWith(ext))) {\n            this.showNotification('ä»…æ”¯æŒ Markdown æ‰©å±•å');\n            return;\n        }\n        const dirPath = parentFile && parentFile.type === 'directory' ? (parentFile.path || parentFile.name) : '';\n        const target = dirPath ? `${dirPath}/${fileName}` : fileName;\n        try {\n            const res = await fetch(`/api/file/${encodeURIComponent(target)}`, {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ content: '' })\n            });\n            const data = await res.json();\n            if (!res.ok || !data.success) {\n                this.showNotification(data.error || `åˆ›å»ºå¤±è´¥ï¼ˆ${res.status}ï¼‰`);\n                return;\n            }\n            this.showNotification(`å·²åˆ›å»ºï¼š${target}`);\n            // åˆ·æ–°æ–‡ä»¶æ ‘ï¼Œå¹¶è·³è½¬åˆ°ç¼–è¾‘å™¨\n            await this.loadFiles();\n            const returnUrl = window.location.pathname + window.location.search;\n            const editUrl = `/editor.html?file=${encodeURIComponent(target)}&return=${encodeURIComponent(returnUrl)}`;\n            window.location.href = editUrl;\n        } catch (err) {\n            console.error('åˆ›å»ºæ–‡ä»¶å¤±è´¥', err);\n            this.showNotification('åˆ›å»ºæ–‡ä»¶å¤±è´¥');\n        }\n    }\n    \n    createNewDirectory(parentFile) {\n        const dirName = prompt('è¯·è¾“å…¥æ–°æ–‡ä»¶å¤¹åç§°:');\n        if (dirName) {\n            this.showNotification(`åˆ›å»ºæ–‡ä»¶å¤¹: ${dirName}`);\n            // è¿™é‡Œå¯ä»¥æ·»åŠ å®é™…çš„æ–‡ä»¶å¤¹åˆ›å»ºé€»è¾‘\n        }\n    }\n    \n    showNotification(message) {\n        // åˆ›å»ºé€šçŸ¥å…ƒç´ \n        const notification = document.createElement('div');\n        notification.style.cssText = `\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            background: var(--accent-color, #007bff);\n            color: white;\n            padding: 1rem 1.5rem;\n            border-radius: 0.5rem;\n            box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n            z-index: 10000;\n            font-size: 0.875rem;\n            max-width: 300px;\n            word-wrap: break-word;\n        `;\n        notification.textContent = message;\n        \n        document.body.appendChild(notification);\n        \n        // 3ç§’åè‡ªåŠ¨ç§»é™¤\n        setTimeout(() => {\n            if (notification.parentNode) {\n                notification.parentNode.removeChild(notification);\n            }\n        }, 3000);\n    }\n\n    openNewFileModal(parentDir) {\n        const backdrop = document.getElementById('newfile-modal');\n        const dirInput = document.getElementById('newfile-dir');\n        const nameInput = document.getElementById('newfile-name');\n        if (!backdrop || !dirInput || !nameInput) {\n            // å›é€€ï¼šè‹¥é¡µé¢æ— å¼¹çª—ï¼Œä½¿ç”¨ prompt\n            this.createNewFile(parentDir);\n            return;\n        }\n        // é»˜è®¤é€‰ä¸­å½“å‰ç›®å½•\n        const dirPath = parentDir && parentDir.type === 'directory' ? (parentDir.path || parentDir.name) : '';\n        dirInput.value = dirPath || '';\n        nameInput.value = '';\n        backdrop.style.display = 'flex';\n\n        const cancel = document.getElementById('newfile-cancel');\n        const confirm = document.getElementById('newfile-confirm');\n        const onCancel = () => { backdrop.style.display = 'none'; cleanup(); };\n        const onConfirm = () => { this.confirmCreateNewFile(); cleanup(); };\n        const onBackdrop = (e) => { if (e.target === backdrop) onCancel(); };\n        const onKey = (e) => { if (e.key === 'Escape') onCancel(); };\n\n        cancel.addEventListener('click', onCancel);\n        confirm.addEventListener('click', onConfirm);\n        backdrop.addEventListener('click', onBackdrop);\n        document.addEventListener('keydown', onKey, { once: true });\n\n        function cleanup(){\n            cancel.removeEventListener('click', onCancel);\n            confirm.removeEventListener('click', onConfirm);\n            backdrop.removeEventListener('click', onBackdrop);\n        }\n    }\n\n    renderNewFileTree() {\n        const host = document.getElementById('newfile-tree');\n        if (!host) return;\n        host.innerHTML = '';\n        const renderNode = (node, parentPath='') => {\n            const fullPath = node.type === 'directory' ? (parentPath ? `${parentPath}/${node.name}` : node.name) : node.path;\n            const item = document.createElement('div');\n            item.className = 'tree-item';\n            item.textContent = node.name;\n            item.title = fullPath;\n            if (node.type === 'directory') {\n                item.addEventListener('click', () => {\n                    const dirInput = document.getElementById('newfile-dir');\n                    if (dirInput) dirInput.value = fullPath;\n                    // é«˜äº®é€‰ä¸­\n                    host.querySelectorAll('.tree-item').forEach(el => el.classList.remove('selected'));\n                    item.classList.add('selected');\n                });\n                host.appendChild(item);\n                if (node.children && node.children.length) {\n                    node.children.forEach(child => renderNode(child, fullPath));\n                }\n            }\n        };\n        this.files.forEach(root => renderNode(root, ''));\n    }\n\n    async confirmCreateNewFile() {\n        const backdrop = document.getElementById('newfile-modal');\n        const dirInput = document.getElementById('newfile-dir');\n        const nameInput = document.getElementById('newfile-name');\n        const dir = dirInput ? dirInput.value.trim() : '';\n        const name = nameInput ? nameInput.value.trim() : '';\n        const allowed = ['.md', '.markdown', '.mdown', '.mkd', '.mkdn'];\n        const lower = name.toLowerCase();\n        if (!name || !allowed.some(ext => lower.endsWith(ext))) {\n            this.showNotification('è¯·è¾“å…¥åˆæ³•çš„ Markdown æ–‡ä»¶å');\n            return;\n        }\n        const target = dir ? `${dir}/${name}` : name;\n        try {\n            const res = await fetch(`/api/file/${encodeURIComponent(target)}`, {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ content: '' })\n            });\n            const data = await res.json();\n            if (!res.ok || !data.success) {\n                this.showNotification(data.error || `åˆ›å»ºå¤±è´¥ï¼ˆ${res.status}ï¼‰`);\n                return;\n            }\n            if (backdrop) backdrop.style.display = 'none';\n            await this.loadFiles();\n            const returnUrl = window.location.pathname + window.location.search;\n            const editUrl = `/editor.html?file=${encodeURIComponent(target)}&return=${encodeURIComponent(returnUrl)}`;\n            window.location.href = editUrl;\n        } catch (err) {\n            console.error('åˆ›å»ºæ–‡ä»¶å¤±è´¥', err);\n            this.showNotification('åˆ›å»ºæ–‡ä»¶å¤±è´¥');\n        }\n    }\n\n    async loadFiles() {\n        try {\n            this.container.innerHTML = '<div class=\"loading\">åŠ è½½ä¸­...</div>';\n            const response = await fetch('/api/files');\n            this.files = await response.json();\n            this.render();\n            // åŒæ­¥åˆ°æ–°å»ºå¼¹çª—çš„ç›®å½•æ ‘\n            this.renderNewFileTree();\n        } catch (error) {\n            console.error('Error loading files:', error);\n            this.container.innerHTML = '<div class=\"error\">åŠ è½½æ–‡ä»¶å¤±è´¥</div>';\n        }\n    }\n\n    render() {\n        if (this.files.length === 0) {\n            this.container.innerHTML = '<div class=\"placeholder\">æœªæ‰¾åˆ° Markdown æ–‡ä»¶</div>';\n            return;\n        }\n\n        this.container.innerHTML = '';\n        this.files.forEach(file => {\n            this.container.appendChild(this.createFileElement(file));\n        });\n    }\n\n    createFileElement(file, level = 0) {\n        const element = document.createElement('div');\n        element.className = `file-tree-item ${file.type}`;\n        element.style.paddingLeft = `${level * 1.5 + 0.5}rem`;\n        element.setAttribute('data-level', level);\n        element.setAttribute('data-name', file.name);\n        if (file.path) {\n            element.setAttribute('data-path', file.path);\n        }\n        \n        if (file.type === 'directory') {\n            const expandIcon = document.createElement('span');\n            expandIcon.className = `expand-icon ${file.expanded ? 'expanded' : ''}`;\n            expandIcon.textContent = 'â–¶';\n            expandIcon.setAttribute('aria-expanded', file.expanded ? 'true' : 'false');\n            element.appendChild(expandIcon);\n            \n            const icon = document.createElement('span');\n            icon.className = 'file-icon';\n            icon.textContent = file.expanded ? 'ğŸ“‚' : 'ğŸ“';\n            element.appendChild(icon);\n            \n            const name = document.createElement('span');\n            name.textContent = file.name;\n            name.className = 'file-name';\n            element.appendChild(name);\n\n            // ç›®å½•çº§â€œ+â€æ–°å»ºæ–‡ä»¶æŒ‰é’®\n            const addBtn = document.createElement('button');\n            addBtn.className = 'add-file-btn';\n            addBtn.textContent = '+';\n            addBtn.title = 'æ–°å»ºæ–‡ä»¶';\n            addBtn.addEventListener('click', (e) => {\n                e.stopPropagation();\n                this.openNewFileModal(file);\n            });\n            element.appendChild(addBtn);\n            \n            // æ·»åŠ åŒå‡»äº‹ä»¶æ”¯æŒ\n            element.addEventListener('dblclick', (e) => {\n                e.stopPropagation();\n                this.toggleDirectory(file, element);\n            });\n            \n            element.addEventListener('click', (e) => {\n                e.stopPropagation();\n                this.toggleDirectory(file, element);\n            });\n            \n            // æ·»åŠ å³é”®èœå•äº‹ä»¶\n            element.addEventListener('contextmenu', (e) => {\n                e.preventDefault();\n                e.stopPropagation();\n                this.showContextMenu(e, file);\n            });\n            \n            if (file.children && file.children.length > 0) {\n                const childrenContainer = document.createElement('div');\n                childrenContainer.className = 'file-tree-children' + (file.expanded ? ' expanded' : '');\n                childrenContainer.style.maxHeight = file.expanded ? '1000px' : '0';\n                childrenContainer.style.overflow = 'hidden';\n                childrenContainer.style.transition = 'max-height 0.3s ease, opacity 0.3s ease';\n                if (file.expanded) {\n                    childrenContainer.style.opacity = '1';\n                }\n                \n                file.children.forEach(child => {\n                    childrenContainer.appendChild(this.createFileElement(child, level + 1));\n                });\n                \n                const wrapper = document.createElement('div');\n                wrapper.className = 'file-tree-wrapper';\n                wrapper.appendChild(element);\n                wrapper.appendChild(childrenContainer);\n                \n                // åˆæ¬¡å±•å¼€çš„åŠ¨ç”»\n                if (file.expanded) {\n                    setTimeout(() => {\n                        childrenContainer.style.maxHeight = childrenContainer.scrollHeight + 'px';\n                        childrenContainer.style.opacity = '1';\n                    }, 10);\n                }\n                \n                return wrapper;\n            }\n        } else {\n            const icon = document.createElement('span');\n            icon.className = 'file-icon';\n            icon.textContent = 'ğŸ“„';\n            element.appendChild(icon);\n            \n            const name = document.createElement('span');\n            name.textContent = file.name;\n            name.className = 'file-name';\n            element.appendChild(name);\n            \n            element.addEventListener('click', (e) => {\n                e.stopPropagation();\n                this.selectFile(file, element);\n            });\n            \n            // æ·»åŠ å³é”®èœå•äº‹ä»¶\n            element.addEventListener('contextmenu', (e) => {\n                e.preventDefault();\n                e.stopPropagation();\n                this.showContextMenu(e, file);\n            });\n            \n            if (this.currentFile && this.currentFile.path === file.path) {\n                element.classList.add('active');\n            }\n        }\n        \n        return element;\n    }\n\n    toggleDirectory(directory, element) {\n        const wasExpanded = directory.expanded;\n        directory.expanded = !directory.expanded;\n        \n        // è·å–å±•å¼€å›¾æ ‡å’Œæ–‡ä»¶å¤¹å›¾æ ‡\n        const expandIcon = element.querySelector('.expand-icon');\n        const folderIcon = element.querySelector('.file-icon');\n        // ç²¾ç¡®å®šä½ç´§é‚»å­å®¹å™¨ï¼Œé¿å…é€‰åˆ°å…¶ä»–å±‚çº§\n        const sibling = element.nextElementSibling;\n        const childrenContainer = sibling && sibling.classList && sibling.classList.contains('file-tree-children') ? sibling : null;\n        \n        if (expandIcon) {\n            expandIcon.classList.toggle('expanded', directory.expanded);\n            expandIcon.setAttribute('aria-expanded', directory.expanded ? 'true' : 'false');\n        }\n        \n        if (folderIcon) {\n            folderIcon.textContent = directory.expanded ? 'ğŸ“‚' : 'ğŸ“';\n        }\n        \n        if (childrenContainer) {\n            if (directory.expanded) {\n                // å±•å¼€åŠ¨ç”»\n                childrenContainer.classList.add('expanded');\n                childrenContainer.style.maxHeight = '0';\n                childrenContainer.style.opacity = '0';\n                \n                setTimeout(() => {\n                    childrenContainer.style.maxHeight = childrenContainer.scrollHeight + 'px';\n                    childrenContainer.style.opacity = '1';\n                }, 10);\n                \n                // åŠ¨ç”»ç»“æŸåé‡ç½®max-height\n                setTimeout(() => {\n                    childrenContainer.style.maxHeight = 'none';\n                }, 300);\n            } else {\n                // æ”¶ç¼©åŠ¨ç”»\n                childrenContainer.style.maxHeight = childrenContainer.scrollHeight + 'px';\n                \n                setTimeout(() => {\n                    childrenContainer.style.maxHeight = '0';\n                    childrenContainer.style.opacity = '0';\n                    childrenContainer.classList.remove('expanded');\n                }, 10);\n            }\n        } else {\n            // å¦‚æœæ²¡æœ‰å­å®¹å™¨ï¼Œé‡æ–°æ¸²æŸ“æ•´ä¸ªæ ‘ï¼Œä½¿æ–°ç»“æ„ï¼ˆå«å­å®¹å™¨ï¼‰å¯è§\n            this.render();\n        }\n    }\n\n    selectFile(file, element) {\n        if (this.currentFile) {\n            const prevActive = this.container.querySelector('.file-tree-item.active');\n            if (prevActive) {\n                prevActive.classList.remove('active');\n            }\n        }\n        \n        this.currentFile = file;\n        if (element) {\n            element.classList.add('active');\n        }\n        \n        if (this.onFileSelect) {\n            this.onFileSelect(file);\n        }\n    }\n\n    setCurrentFile(file) {\n        this.currentFile = file;\n        this.render();\n    }\n\n    updateBreadcrumb(path) {\n        const breadcrumb = document.getElementById('breadcrumb');\n        const parts = path.split('/').filter(part => part);\n        \n        // æ¸…ç©ºé¢åŒ…å±‘å¹¶é‡æ–°æ„å»ºï¼Œç¡®ä¿ç§»é™¤æ—§çš„äº‹ä»¶ç›‘å¬å™¨\n        breadcrumb.innerHTML = '';\n        \n        // æ·»åŠ æ ¹ç›®å½•\n        const rootItem = document.createElement('span');\n        rootItem.className = 'breadcrumb-item';\n        rootItem.setAttribute('data-path', '');\n        rootItem.textContent = 'æ ¹ç›®å½•';\n        rootItem.style.cursor = 'pointer';\n        rootItem.addEventListener('click', (e) => {\n            e.stopPropagation();\n            this.loadFiles();\n        });\n        breadcrumb.appendChild(rootItem);\n        \n        let currentPath = '';\n        parts.forEach((part, index) => {\n            // æ·»åŠ åˆ†éš”ç¬¦\n            const separator = document.createElement('span');\n            separator.textContent = ' / ';\n            breadcrumb.appendChild(separator);\n            \n            // æ·»åŠ è·¯å¾„éƒ¨åˆ†\n            currentPath += (index === 0 ? '' : '/') + part;\n            const pathItem = document.createElement('span');\n            pathItem.className = 'breadcrumb-item';\n            pathItem.setAttribute('data-path', currentPath);\n            pathItem.textContent = part;\n            pathItem.style.cursor = 'pointer';\n            pathItem.addEventListener('click', (e) => {\n                e.stopPropagation();\n                const itemPath = e.currentTarget.getAttribute('data-path');\n                if (itemPath) {\n                    this.navigateToPath(itemPath);\n                }\n            });\n            \n            // æ·»åŠ æ‚¬åœæ•ˆæœ\n            pathItem.addEventListener('mouseenter', () => {\n                pathItem.style.color = 'var(--accent-color, #007bff)';\n                pathItem.style.textDecoration = 'underline';\n            });\n            \n            pathItem.addEventListener('mouseleave', () => {\n                pathItem.style.color = '';\n                pathItem.style.textDecoration = '';\n            });\n            \n            breadcrumb.appendChild(pathItem);\n        });\n    }\n    \n    navigateToPath(targetPath) {\n        console.log('Navigating to path:', targetPath);\n        // æŸ¥æ‰¾å¯¹åº”çš„è·¯å¾„å¹¶å±•å¼€\n        const findAndExpandPath = (files, targetPath, currentPath = '') => {\n            for (const file of files) {\n                const fullPath = currentPath ? `${currentPath}/${file.name}` : file.name;\n                \n                if (fullPath === targetPath) {\n                    if (file.type === 'directory') {\n                        // ç¡®ä¿ç›®å½•è¢«å±•å¼€\n                        if (!file.expanded) {\n                            file.expanded = true;\n                        }\n                        this.render();\n                        // æ»šåŠ¨åˆ°è¯¥ç›®å½•ä½ç½®\n                        setTimeout(() => {\n                            const element = this.findElementByPath(targetPath);\n                            if (element) {\n                                element.scrollIntoView({ behavior: 'smooth', block: 'center' });\n                                element.classList.add('highlighted');\n                                setTimeout(() => {\n                                    element.classList.remove('highlighted');\n                                }, 1000);\n                            }\n                        }, 100);\n                        return true;\n                    } else if (file.type === 'file') {\n                        this.selectFile(file, null);\n                        return true;\n                    }\n                }\n                \n                if (file.type === 'directory' && file.children) {\n                    if (findAndExpandPath(file.children, targetPath, fullPath)) {\n                        file.expanded = true;\n                        this.render();\n                        return true;\n                    }\n                }\n            }\n            return false;\n        };\n        \n        // å¦‚æœç‚¹å‡»çš„æ˜¯ç›®å½•ï¼Œåˆ‡æ¢å±•å¼€çŠ¶æ€ï¼›å¦‚æœæ˜¯æ–‡ä»¶ï¼Œé€‰æ‹©æ–‡ä»¶\n        const targetFile = this.findFileByPath(this.files, targetPath);\n        if (targetFile) {\n            if (targetFile.type === 'directory') {\n                targetFile.expanded = !targetFile.expanded;\n                this.render();\n            } else if (targetFile.type === 'file') {\n                this.selectFile(targetFile, null);\n            }\n        } else {\n            // å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œå°è¯•å±•å¼€è·¯å¾„\n            findAndExpandPath(this.files, targetPath);\n        }\n    }\n    \n    findElementByPath(targetPath) {\n        const items = this.container.querySelectorAll('.file-tree-item');\n        for (const item of items) {\n            const path = item.getAttribute('data-path');\n            if (path === targetPath) return item;\n        }\n        return null;\n    }\n\n    findFileByPath(files, targetPath, currentPath = '') {\n        for (const file of files) {\n            const fullPath = currentPath ? `${currentPath}/${file.name}` : file.name;\n            \n            if (fullPath === targetPath) {\n                return file;\n            }\n            \n            if (file.type === 'directory' && file.children) {\n                const found = this.findFileByPath(file.children, targetPath, fullPath);\n                if (found) return found;\n            }\n        }\n        return null;\n    }\n}\n\nwindow.FileTree = FileTree;", type: "application/javascript; charset=utf-8" },
  "/js/renderer.js": { content: "class MarkdownRenderer {\n    constructor() {\n        this.setupMarked();\n        this.setupMermaid();\n    }\n\n    setupMarked() {\n        if (typeof marked === 'undefined') {\n            console.error('marked.js is not loaded');\n            return;\n        }\n\n        // æ£€æŸ¥marked.jsç‰ˆæœ¬\n        console.log('Marked version:', marked.version);\n\n        marked.setOptions({\n            breaks: true,\n            gfm: true,\n            headerIds: true,\n            mangle: false,\n            sanitize: false,\n            smartLists: true,\n            smartypants: true,\n            xhtml: false\n        });\n\n        const renderer = new marked.Renderer();\n        \n        // è‡ªå®šä¹‰æ ‡é¢˜æ¸²æŸ“ï¼Œç¡®ä¿ç”ŸæˆID\n        renderer.heading = (text, level, raw, slugger) => {\n            console.log('Rendering heading:', text, 'Level:', level);\n            const id = raw.toLowerCase()\n                .replace(/[^\\w\\s-]/g, '')\n                .replace(/\\s+/g, '-')\n                .replace(/-+/g, '-')\n                .replace(/^-|-$/g, '');\n            const headingId = `heading-${id}-${Date.now()}`;\n            return `<h${level} id=\"${headingId}\">${text}</h${level}>`;\n        };\n        \n        renderer.code = (code, language) => {\n            if (language === 'mermaid') {\n                return `<div class=\"mermaid\">${code}</div>`;\n            } else if (language === 'plantuml') {\n                return this.renderPlantUML(code);\n            } else {\n                const validLang = language && Prism.languages[language] ? language : 'text';\n                const highlighted = Prism.highlight(code, Prism.languages[validLang], validLang);\n                return `<pre><code class=\"language-${validLang}\">${highlighted}</code></pre>`;\n            }\n        };\n\n        renderer.table = (header, body) => {\n            return `<div class=\"table-wrapper\"><table class=\"table\"><thead>${header}</thead><tbody>${body}</tbody></table></div>`;\n        };\n\n        renderer.image = (href, title, text) => {\n            const titleAttr = title ? ` title=\"${title}\"` : '';\n            return `<img src=\"${href}\" alt=\"${text}\"${titleAttr} loading=\"lazy\">`;\n        };\n\n        renderer.link = (href, title, text) => {\n            const isExternal = href.startsWith('http') && !href.includes(window.location.host);\n            const targetAttr = isExternal ? ' target=\"_blank\" rel=\"noopener noreferrer\"' : '';\n            const titleAttr = title ? ` title=\"${title}\"` : '';\n            return `<a href=\"${href}\"${titleAttr}${targetAttr}>${text}</a>`;\n        };\n\n        marked.use({ renderer });\n    }\n\n    setupMermaid() {\n        if (typeof mermaid === 'undefined') {\n            console.error('mermaid.js is not loaded');\n            return;\n        }\n\n        mermaid.initialize({\n            startOnLoad: false,\n            theme: 'default',\n            themeVariables: {\n                darkMode: false,\n                primaryColor: '#007bff',\n                primaryTextColor: '#ffffff',\n                primaryBorderColor: '#0056b3',\n                lineColor: '#6c757d'\n            },\n            flowchart: {\n                useMaxWidth: true,\n                htmlLabels: true\n            },\n            sequence: {\n                useMaxWidth: true\n            },\n            gantt: {\n                useMaxWidth: true\n            }\n        });\n    }\n\n    renderPlantUML(code) {\n        try {\n            const encoded = this.encodePlantUML(code.trim());\n            const plantUMLServer = 'https://www.plantuml.com/plantuml/svg/';\n            const url = plantUMLServer + encoded;\n            return `<div class=\"plantuml\"><img src=\"${url}\" alt=\"PlantUML Diagram\" loading=\"lazy\"></div>`;\n        } catch (error) {\n            console.error('PlantUML encoding error:', error);\n            return `<pre><code class=\"language-plantuml\">${code}</code></pre>`;\n        }\n    }\n\n    encodePlantUML(text) {\n        function encode6bit(b) {\n            if (b < 10) return String.fromCharCode(48 + b);\n            b -= 10;\n            if (b < 26) return String.fromCharCode(65 + b);\n            b -= 26;\n            if (b < 26) return String.fromCharCode(97 + b);\n            b -= 26;\n            if (b === 0) return '-';\n            if (b === 1) return '_';\n            return '?';\n        }\n\n        function append3bytes(b1, b2, b3) {\n            const c1 = b1 >> 2;\n            const c2 = ((b1 & 0x3) << 4) | (b2 >> 4);\n            const c3 = ((b2 & 0xF) << 2) | (b3 >> 6);\n            const c4 = b3 & 0x3F;\n            \n            let result = \"\";\n            result += encode6bit(c1 & 0x3F);\n            result += encode6bit(c2 & 0x3F);\n            result += encode6bit(c3 & 0x3F);\n            result += encode6bit(c4 & 0x3F);\n            \n            return result;\n        }\n\n        let result = \"\";\n        for (let i = 0; i < text.length; i += 3) {\n            const b1 = text.charCodeAt(i);\n            const b2 = i + 1 < text.length ? text.charCodeAt(i + 1) : 0;\n            const b3 = i + 2 < text.length ? text.charCodeAt(i + 2) : 0;\n            result += append3bytes(b1, b2, b3);\n        }\n        \n        return result;\n    }\n\n    async renderMarkdown(content) {\n        if (typeof marked === 'undefined') {\n            return '<p>Error: marked.js is not loaded</p>';\n        }\n\n        try {\n            // ä½¿ç”¨markedé»˜è®¤æ¸²æŸ“ï¼Œç¨ååœ¨renderContentä¸­ç»Ÿä¸€å¤„ç†æ ‡é¢˜ID\n            const html = await marked.parse(content);\n            return html;\n        } catch (error) {\n            console.error('Markdown rendering error:', error);\n            return `<p>Error rendering markdown: ${error.message}</p>`;\n        }\n    }\n\n    async renderMermaidDiagrams() {\n        if (typeof mermaid === 'undefined') {\n            console.error('mermaid.js is not loaded');\n            return;\n        }\n\n        const mermaidElements = document.querySelectorAll('.mermaid');\n        for (const element of mermaidElements) {\n            try {\n                const graphDefinition = element.textContent;\n                const { svg } = await mermaid.render('mermaid-' + Date.now(), graphDefinition);\n                element.innerHTML = svg;\n            } catch (error) {\n                console.error('Mermaid rendering error:', error);\n                element.innerHTML = `<div class=\"error\">Error rendering mermaid diagram: ${error.message}</div>`;\n            }\n        }\n    }\n\n    async renderContent(content, targetId = 'content-body') {\n        const html = await this.renderMarkdown(content);\n        \n        const tempDiv = document.createElement('div');\n        tempDiv.innerHTML = html;\n        \n        // ä½¿ç”¨ä¸æœåŠ¡å™¨ç«¯ç›¸åŒçš„é€»è¾‘ç”Ÿæˆæ ‡é¢˜ID\n        const serverOutline = this.extractOutline(content);\n        const headings = tempDiv.querySelectorAll('h1, h2, h3, h4, h5, h6');\n        \n        headings.forEach((heading, index) => {\n            if (serverOutline[index]) {\n                heading.id = serverOutline[index].id;\n                console.log('Set heading ID:', serverOutline[index].id, 'for text:', heading.textContent);\n            }\n        });\n        \n        const container = document.getElementById(targetId);\n        if (!container) {\n            throw new Error(`Render target not found: ${targetId}`);\n        }\n        container.innerHTML = '';\n        container.appendChild(tempDiv);\n        \n        await this.renderMermaidDiagrams();\n        \n        Prism.highlightAllUnder(tempDiv);\n        \n        // è¿”å›ä¸æœåŠ¡å™¨ç«¯ä¸€è‡´çš„å¤§çº²æ•°æ®\n        return serverOutline;\n    }\n\n    extractOutline(content) {\n        const outline = [];\n        const lines = content.split('\\n');\n        let headingIndex = 0;\n        \n        for (let i = 0; i < lines.length; i++) {\n            const line = lines[i].trim();\n            const match = line.match(/^(#{1,6})\\s+(.+)$/);\n            \n            if (match) {\n                const level = match[1].length;\n                const text = match[2].trim();\n                const id = text.toLowerCase()\n                    .replace(/[^\\w\\s-]/g, '')\n                    .replace(/\\s+/g, '-')\n                    .replace(/-+/g, '-')\n                    .replace(/^-|-$/g, '');\n                \n                const headingId = `heading-${id}-${headingIndex}`;\n                outline.push({ level, text, id: headingId });\n                headingIndex++;\n            }\n        }\n        \n        return outline;\n    }\n}\n\nwindow.MarkdownRenderer = MarkdownRenderer;", type: "application/javascript; charset=utf-8" },
};
//AIGC END
